
<!DOCTYPE html>
<html class="html-loading">
		

<head>
	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <title>
    
      web基础-1-js基础知识 | 陈立林的个人网站
    
  </title>
  <meta name="author" content="来者可追">
  <meta name="keywords" content="" />
  <meta name="description" content="" />
	<!-- favicon -->
  <link rel="shortcut icon" href="../../../../../img/favicon.ico">

  <!-- css -->
  
<link rel="stylesheet" href="../../../../../css/Annie.css">

  
  <!-- jquery -->
	
<script src="../../../../../plugin/jquery/jquery.min.js"></script>


<script>
    const CONFIG_BGIMAGE = {
      mode: 'normal',
      normalSrc: '../../../../../https:/source.unsplash.com/collection/954550/1920x1080',
      randomYouMax: 110,
      randomYouSrc: '../../../../../https:/sariay.github.io/Random-img/',
	  randomOtherSrc: '../../../../../https:/api.berryapi.net/?service=App.Bing.Images&day=-0',
	  preloaderEnable: false
    }
	
    const CONFIG_LEACLOUD_COUNT = {
      enable: false,
	  appId: 'AU8...',
	  appKey: '4cU...',
	  serverURLs: 'http' || ' '
    }
  </script>
<meta name="generator" content="Hexo 4.2.1"></head>
	<body>
		<!-- Preloader -->


<!-- header -->
<header class="fixbackground bg-pan-br">
	<div class="mask">
		<!-- motto -->
		<div class="h-body">	
			
				<div class="motto text-shadow-pop-left">
					<p class="content" id="motto-content">获取中...</p>
					<p>-<p>
					<p class="author" id="motto-author">Just a minute...</p>
				</div>
			
		</div>
		
		<!-- others: such as time... -->			
		<div class="h-footer">
			<a href="javascript:;" id="read-more" class="scroll-down">
				<span class="icon-anchor1 animation-scroll-down"></span>
			</a>
		</div>
	</div>
</header>

<div id="navigation-hide">
	<!-- Progress bar -->
	<div id="progress-bar"></div>

	<!-- Progress percent -->
	<div id="progress-percentage"><span>0.0%</span></div>

	<div class="toc-switch"><span class="switch-button">目录</span></div>

	<!-- Page title -->
	<p>
		
			「web基础-1-js基础知识」
		
	</p>

	
	

	<!-- Nav trigger for navigation-H-->
	<a class="nav-trigger"><span></span></a>
</div>

<!-- Navigation in div(id="navigation-H") -->
<nav class="nav-container" id="cd-nav">
	<div class="nav-header">
		<span class="logo"> 
			<img src="../../../../../img/logo.png">
		</span>
		<a href="javascript:;" class="nav-close"></a>
	</div>
	
	<div class="nav-body">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="../../../../../index.html" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="../../../../../archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="../../../../../tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="../../../../../about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="../../../../../gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
	</div>
	
	<div class="nav-footer">
		<ul id="global-social">
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-one"><span class="path1"></span><span class="path2"></span></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-zhihu"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-github"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-sina-weibo "></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-pinterest2"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-instagram"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-twitter"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../atom.xml" target="_blank">
				<span class="icon-rss"></span>
			</a>
		</li>
			
</ul>

	</div>
</nav>
			
		<!--main-->
		<main>
			<!--
	时间：2018-11-17
	描述：
		插件名称：katelog.min.js
		插件作者：KELEN
		插件来源: https://github.com/KELEN/katelog
-->

	
		<div class="layout-toc">
			<div id="layout-toc">
				<div class="k-catelog-list" id="catelog-list" data-title="文章目录"></div>
			</div>
		</div>

		
<script src="../../../../../plugin/toc/katelog.min.js"></script>


		
	 

<div class="layout-post">
	<div id="layout-post">
		<div class="article-title">
			
	<a href="" itemprop="url">
		web基础-1-js基础知识
	</a>

		</div>

		<div class="article-meta">
			<span>
				<i class="icon-calendar1"></i>
				
				




	更新于

	<a href="" itemprop="url">
		<time datetime="2020-11-10T05:59:40.000Z" itemprop="dateUpdated">
	  		2021-05-06
	  </time>
	</a> 



			</span>
			<span>
				
	<i class="icon-price-tags"></i>
	
		<a href="../../../../../tags/javascript/" class=" ">
			javascript
		</a>
	
		
			</span>
			
			



		</div>

		<div class="article-content" id="article-content" >
			<p>变量类型、原型、作用域、闭包、异步</p>
<p>慕课网视频地址：<a href="https://coding.imooc.com/class/400.html" target="_blank" rel="noopener">https://coding.imooc.com/class/400.html</a></p>
<a id="more"></a>
<h1 id="第二章-准备"><a href="#第二章-准备" class="headerlink" title="第二章 准备"></a>第二章 准备</h1><h1 id="第三章-CSS部分"><a href="#第三章-CSS部分" class="headerlink" title="第三章 CSS部分"></a>第三章 CSS部分</h1><h2 id="3-1、html-css面试介绍"><a href="#3-1、html-css面试介绍" class="headerlink" title="3-1、html\css面试介绍"></a>3-1、html\css面试介绍</h2><p><strong>HTML面试题</strong></p>
<ul>
<li>如何理解HTML语义化</li>
<li>默认情况下，哪些HTML标签是块级元素、哪些是内联元素</li>
</ul>
<p><strong>CSS面试题</strong></p>
<ul>
<li>布局<ul>
<li>盒子模型的宽度如何计算</li>
<li>margin 纵向重叠的问题</li>
<li>margin 负值的问题</li>
<li>BFC 理解和应用</li>
<li>float 布局的问题，以及 clearfix</li>
<li>flex 画色子</li>
</ul>
</li>
<li>定位<ul>
<li>absolute 和 relative 分别依据什么定位</li>
<li>居中对齐有哪些实现方式</li>
</ul>
</li>
<li>图文样式<ul>
<li>line-height 的继承问题</li>
</ul>
</li>
<li>CSS 响应式<ul>
<li>rem 是什么</li>
<li>如何实现响应式</li>
</ul>
</li>
<li>CSS3<ul>
<li>关于 CSS3 动画</li>
</ul>
</li>
</ul>
<h2 id="3-2、HTML面试题"><a href="#3-2、HTML面试题" class="headerlink" title="3-2、HTML面试题"></a>3-2、HTML面试题</h2><p><strong>如何理解HTML语义化</strong></p>
<ul>
<li>让人更容易读懂（增加代码可读性）</li>
<li>让搜索引擎更容易读懂（SEO）</li>
</ul>
<p><strong>默认情况下，哪些HTML标签是块级元素、哪些是内联元素</strong></p>
<ul>
<li>display:block/table；有 div h1 h2 table ul ol p 等</li>
<li>display:inline/inline-block；有 span img input button em 等</li>
</ul>
<h2 id="3-3、布局-题目"><a href="#3-3、布局-题目" class="headerlink" title="3-3、布局 - 题目"></a>3-3、布局 - 题目</h2><h2 id="3-4、布局-题目（一）-盒模型宽度、margin纵向重叠"><a href="#3-4、布局-题目（一）-盒模型宽度、margin纵向重叠" class="headerlink" title="3-4、布局 - 题目（一） - 盒模型宽度、margin纵向重叠"></a>3-4、布局 - 题目（一） - 盒模型宽度、margin纵向重叠</h2><p><strong>盒模型宽度计算</strong></p>
<p>题目：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 计算盒模型的宽度 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">        <span class="selector-id">#div1</span> &#123;</span></span><br><span class="line"><span class="undefined">            width: 100px;</span></span><br><span class="line"><span class="undefined">            padding: 10px;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ccc</span>;</span></span><br><span class="line"><span class="undefined">            margin: 10px;</span></span><br><span class="line"><span class="undefined">            box-sizing: border-box;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span>&gt;</span></span><br><span class="line">        this is div1</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>offsetWidth = （内容宽度 + 内边距 + 边框），无外边距，</li>
<li>因此答案是：122px</li>
<li>如果让 offsetWidth =100px,需要 box-sizing:border-box，<ul>
<li>通过减少内容宽度，整体宽度会变成100，</li>
</ul>
</li>
</ul>
<p><strong>margin纵向重叠问题</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    p &#123;</span></span><br><span class="line"><span class="undefined">        font-size: 16px;</span></span><br><span class="line"><span class="undefined">        line-height: 1;</span></span><br><span class="line"><span class="undefined">        margin-top: 10px;</span></span><br><span class="line"><span class="undefined">        margin-bottom: 15px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>相邻元素的margin-top和margin-bottom会重叠</li>
<li>空内容标签也会重叠  </li>
<li>答案：15px</li>
</ul>
<h2 id="3-5、布局-题目（二）-margin-负值、BFC"><a href="#3-5、布局-题目（二）-margin-负值、BFC" class="headerlink" title="3-5、布局 - 题目（二） margin 负值、BFC"></a>3-5、布局 - 题目（二） margin 负值、BFC</h2><p><strong>margin 负值问题</strong></p>
<ul>
<li>margin-top 和 margin-left 负值，元素向上、向左移动</li>
<li>margin-right 负值，右侧元素左移，自身不受影响</li>
<li>margin-bottom 负值，下方元素上移，自身不受影响</li>
</ul>
<p>核心代码演示：不演示了，比较简单</p>
<p><strong>BFC 理解与应用</strong></p>
<ul>
<li>Block Format Context ，块级格式化上下文</li>
<li>一块独立渲染区域，内部元素的渲染不会影响边界以外的元素</li>
<li>形成 BFC 的常见条件<ul>
<li>float 不是 none</li>
<li>position 是 absolute 或 fixed</li>
<li>overflow 不是 visible</li>
<li>display 是 flex inline-block等</li>
</ul>
</li>
<li>BFC常见应用<ul>
<li>清除浮动</li>
</ul>
</li>
</ul>
<p><strong>BFC 清除浮动核心代码：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#f1f1f1</span>;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="undefined">        float: left;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.bfc</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span>; <span class="comment">/* 触发元素 BFC */</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container bfc"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://www.imooc.com/static/img/index/logo.png"</span> <span class="attr">class</span>=<span class="string">"left"</span> <span class="attr">style</span>=<span class="string">"magin-right: 10px;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"bfc"</span>&gt;</span>某一段文字……<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-6-float-布局-圣杯布局"><a href="#3-6-float-布局-圣杯布局" class="headerlink" title="3-6 float 布局 - 圣杯布局"></a>3-6 float 布局 - 圣杯布局</h2><ul>
<li>使用 float 布局，</li>
<li>两侧使用 margin 负值，以便和中间内容纵向重叠</li>
<li>防止中间内容被两侧覆盖，一个用 padding 一个用 margin </li>
</ul>
<p><strong>圣杯布局 </strong></p>
<p><strong>手写 clearfix</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">    <span class="attribute">display</span>: table;</span><br><span class="line">    <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span>: &#123;</span><br><span class="line">    <span class="attribute">zoom</span>:<span class="number">1</span>; <span class="comment">/* 兼容 IE 低版本 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>三栏布局，中间最先加载，且宽度自适应；两侧内容固定。</p>
<p>关键点：中间宽度有padding，</p>
<ul>
<li>中间：    padding-left: 左侧宽度; padding-right: 右侧宽度</li>
<li>左侧 ：    margin-left: -100%; right:自身宽度</li>
<li>右侧：      margin-right: -自身宽度;</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    body &#123;</span></span><br><span class="line"><span class="undefined">        min-width: 550px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#header</span> &#123;</span></span><br><span class="line"><span class="undefined">        text-align: center;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#f1f1f1</span>;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="selector-id">#container</span> &#123;</span></span><br><span class="line"><span class="undefined">        padding-left: 200px;</span></span><br><span class="line"><span class="undefined">        padding-right: 150px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#container</span> <span class="selector-class">.column</span> &#123;</span></span><br><span class="line"><span class="undefined">        float: left;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="selector-id">#center</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#ccc</span>;</span></span><br><span class="line"><span class="undefined">        width: 100%;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#left</span> &#123;</span></span><br><span class="line"><span class="undefined">        position: relative;</span></span><br><span class="line"><span class="undefined">        background-color: yellow;</span></span><br><span class="line"><span class="undefined">        width: 200px;</span></span><br><span class="line"><span class="undefined">        margin-left: -100%;</span></span><br><span class="line"><span class="undefined">        right: 200px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#right</span> &#123;</span></span><br><span class="line"><span class="undefined">        background-color: red;</span></span><br><span class="line"><span class="undefined">        width: 150px;</span></span><br><span class="line"><span class="undefined">        margin-right: -150px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="selector-id">#footer</span> &#123;</span></span><br><span class="line"><span class="undefined">        text-align: center;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#f1f1f1</span>;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="comment">/* 手写 clearfix */</span></span></span><br><span class="line"><span class="css">    <span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line"><span class="undefined">        content: '';</span></span><br><span class="line"><span class="undefined">        display: table;</span></span><br><span class="line"><span class="undefined">        clear: both;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"header"</span>&gt;</span>this is header<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span> <span class="attr">class</span>=<span class="string">"clearfix"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"center"</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span>this is center<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span>this is left<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"right"</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span>this is right<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"footer"</span>&gt;</span>this is footer<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-7-float-布局-双飞翼布局"><a href="#3-7-float-布局-双飞翼布局" class="headerlink" title="3-7 float 布局 - 双飞翼布局"></a>3-7 float 布局 - 双飞翼布局</h2><p><strong>核心：</strong></p>
<ul>
<li>不同于圣杯布局，中间用margin，而不是padding</li>
<li>margin-left:-100% 、 margin-left:-自身宽度 （而不是margin-right）。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    body &#123;</span></span><br><span class="line"><span class="undefined">        min-width: 550px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.col</span> &#123;</span></span><br><span class="line"><span class="undefined">        float: left;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="selector-id">#main</span> &#123;</span></span><br><span class="line"><span class="undefined">        width: 100%;</span></span><br><span class="line"><span class="undefined">        height: 200px;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#ccc</span>;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#main-wrap</span> &#123;</span></span><br><span class="line"><span class="undefined">        margin: 0 190px 0 190px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="selector-id">#left</span> &#123;</span></span><br><span class="line"><span class="undefined">        width: 190px;</span></span><br><span class="line"><span class="undefined">        height: 200px;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#0000FF</span>;</span></span><br><span class="line"><span class="undefined">        margin-left: -100%;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#right</span> &#123;</span></span><br><span class="line"><span class="undefined">        width: 190px;</span></span><br><span class="line"><span class="undefined">        height: 200px;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-id">#FF0000</span>;</span></span><br><span class="line"><span class="undefined">        margin-left: -190px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"main"</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"main-wrap"</span>&gt;</span></span><br><span class="line">        this is main</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line">    this is left</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"right"</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line">    this is right</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-8-布局-题目-flex-布局"><a href="#3-8-布局-题目-flex-布局" class="headerlink" title="3-8 布局 - 题目 - flex 布局"></a>3-8 布局 - 题目 - flex 布局</h2><p>实现三点骰子  ，大家可以参考阮一峰个人博客里面的</p>
<ul>
<li>flex-direction 主轴方向</li>
<li>justify-content 主轴对齐方式</li>
<li>align-items 交叉轴对齐方式</li>
<li>flex-wrap 是否换行</li>
<li>align-self 子元素在交叉轴对其方式</li>
</ul>
<p>核心代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">    <span class="attribute">align-self</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child(3)</span> &#123;</span><br><span class="line">    <span class="attribute">align-self</span>: flex-end;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-9-定位-题目"><a href="#3-9-定位-题目" class="headerlink" title="3-9 定位 - 题目"></a>3-9 定位 - 题目</h2><p><strong>absolute 和 relatice 依据什么定位</strong></p>
<ul>
<li>relative 依据自身定位</li>
<li>absolute 依据最近一层的定位元素定位 （absolute relative fixed 或 body）</li>
</ul>
<p><strong>居中对齐方式有哪些</strong></p>
<ul>
<li>水平居中<ul>
<li>inline 元素：text-align:center</li>
<li>block 元素 : margin:auto</li>
<li>absolute 元素 :left:50% +margin-left负值 （须知道尺寸）</li>
</ul>
</li>
<li>垂直居中<ul>
<li>inline 元素 :line-height 的值等于 height 值</li>
<li>absolute 元素 : top:50% +margin-top 负值  （须知道尺寸）</li>
<li>absolute 元素 : transform(-50% , -50%)，left、top 50%  </li>
<li>absolute 元素 : top,left,bottom,right =0 + margin :auto</li>
</ul>
</li>
</ul>
<h2 id="3-10-定位-题目"><a href="#3-10-定位-题目" class="headerlink" title="3-10 定位 - 题目"></a>3-10 定位 - 题目</h2><p>代码演示：我就不掩饰了</p>
<h2 id="3-11-CSS-图文样式-line-height-继承"><a href="#3-11-CSS-图文样式-line-height-继承" class="headerlink" title="3-11 CSS 图文样式 - line-height 继承"></a>3-11 CSS 图文样式 - line-height 继承</h2><ul>
<li>line-height 如何继承 ？ 如下，p 的 行高是 40px</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        body &#123;</span></span><br><span class="line"><span class="undefined">            font-size: 20px;</span></span><br><span class="line"><span class="undefined">            line-height: 200%;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        p &#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">background-color</span>: <span class="selector-id">#ccc</span>;</span></span><br><span class="line"><span class="undefined">            font-size: 16px;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一行文字<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>写具体数值，如 30px ，则继承该值</li>
<li>写比例，如 2/1.5 ，则继承该比例</li>
<li>写百分比，如200%，则继承计算出来的值 （当前的line-height * font-size）</li>
</ul>
<h2 id="3-12-响应式-解题"><a href="#3-12-响应式-解题" class="headerlink" title="3-12 响应式 - 解题"></a>3-12 响应式 - 解题</h2><p><strong>rem 是什么</strong></p>
<ul>
<li>rem 是一个长度单位</li>
<li>px，绝对长度单位，最常用</li>
<li>em,相对长度单位，相对于父元素，不常用</li>
<li>rem,相对长度单位，相对于根元素，常用语响应式布局<ul>
<li>定义的时候用 font-size，使用的时候都可以</li>
</ul>
</li>
</ul>
<p><strong>响应式布局的常见方案</strong></p>
<ul>
<li>media-query，根据不同的屏幕宽度设置根元素 font-size</li>
<li>rem,基于根元素的相对单位</li>
</ul>
<p><strong>代码演示：</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">media</span> only screen and (max-width: <span class="number">374px</span>) &#123;</span><br><span class="line">    <span class="comment">/* iphone5 或者更小的尺寸，以 iphone5 的宽度（320px）比例设置 font-size */</span></span><br><span class="line">    <span class="selector-tag">html</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">86px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">media</span> only screen and (min-width: <span class="number">375px</span>) and (max-width: <span class="number">413px</span>) &#123;</span><br><span class="line">    <span class="comment">/* iphone6/7/8 和 iphone x */</span></span><br><span class="line">    <span class="selector-tag">html</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">100px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">media</span> only screen and (min-width: <span class="number">414px</span>) &#123;</span><br><span class="line">    <span class="comment">/* iphone6p 或者更大的尺寸，以 iphone6p 的宽度（414px）比例设置 font-size */</span></span><br><span class="line">    <span class="selector-tag">html</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">110px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-13-响应式-vw-vh"><a href="#3-13-响应式-vw-vh" class="headerlink" title="3-13 响应式 - vw/vh"></a>3-13 响应式 - vw/vh</h2><p><strong>rem的弊端</strong></p>
<ul>
<li>配合media-query 使用的时候，具有“阶梯”性，永远只有那几个标准</li>
</ul>
<p><strong>网页视口尺寸</strong></p>
<ul>
<li>window.screen.height // 屏幕高度</li>
<li>window。innerHeight // 网页视口高度</li>
<li>document.body.clientHeight // body 高度</li>
</ul>
<p><strong>vw/vh</strong></p>
<h1 id="第四章、变量类型和计算"><a href="#第四章、变量类型和计算" class="headerlink" title="第四章、变量类型和计算"></a>第四章、变量类型和计算</h1><h2 id="1、值类型和引用类型"><a href="#1、值类型和引用类型" class="headerlink" title="1、值类型和引用类型"></a>1、值类型和引用类型</h2><h2 id="2、typeof和深拷贝"><a href="#2、typeof和深拷贝" class="headerlink" title="2、typeof和深拷贝"></a>2、typeof和深拷贝</h2><p><strong>typeof运算符</strong></p>
<ul>
<li>判断所有值类型</li>
</ul>
<p><img src="/images/20204/jsreview-01.png" alt="判断所有值类型"></p>
<p><img src="/images/20204/jsreview-02.png" alt="判断所有值类型"></p>
<p><strong>深拷贝</strong></p>
<p>代码演示：新建页面，跑代码</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install http-server -g</span><br><span class="line">http-server -p 8001</span><br></pre></td></tr></table></figure>
<p>深拷贝和浅拷贝：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj1=&#123;</span><br><span class="line">    age:<span class="number">20</span>,</span><br><span class="line">    address:&#123;</span><br><span class="line">        city:<span class="string">'beijing'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    arr:[<span class="string">'a'</span>,<span class="string">'b'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 浅拷贝</span></span><br><span class="line"><span class="comment">// const obj2=obj1;</span></span><br><span class="line"><span class="comment">// obj2.address.city='shanghai';</span></span><br><span class="line"><span class="comment">// 深拷贝</span></span><br><span class="line">obj3=deepClone(obj1)</span><br><span class="line">obj3.address.city=<span class="string">'shanghai'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj1.address.city)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 深拷贝</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">deepClone</span> (<span class="params">obj=&#123;&#125;</span>)</span>&#123;</span><br><span class="line">     <span class="comment">// 不是对象或数组，或是Null，直接返回</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> obj!==<span class="string">'object'</span>||<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 初始化返回结果</span></span><br><span class="line">    <span class="keyword">let</span> result</span><br><span class="line">    <span class="comment">// 判断是数组还是对象</span></span><br><span class="line">    <span class="keyword">if</span>(obj <span class="keyword">instanceof</span> <span class="built_in">Array</span>)&#123;</span><br><span class="line">        result=[]</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        result=&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 数组和对象都能用的遍历</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> obj)&#123;</span><br><span class="line">        <span class="comment">// 保证Key不是原型的属性</span></span><br><span class="line">        <span class="keyword">if</span>(obj.hasOwnProperty(key))&#123;</span><br><span class="line">            <span class="comment">// 递归，防止有深层属性</span></span><br><span class="line">            result[key]=deepClone(obj[key])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="3、变量计算-类型转换"><a href="#3、变量计算-类型转换" class="headerlink" title="3、变量计算-类型转换"></a>3、变量计算-类型转换</h2><p><strong> - 字符串拼接</strong></p>
<p><img src="/images/20204/jsreview-03.png" alt="字符串拼接"></p>
<p><strong> == 运算符</strong></p>
<p>两等运算符会，尽量让转换之后的值相等</p>
<p><img src="/images/20204/jsreview-04.png" alt="运算符"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  除了 == null 之外，其他一律用=== 例如：</span></span><br><span class="line"> <span class="keyword">const</span> obj=&#123;<span class="attr">x</span>:<span class="number">100</span>&#125;;</span><br><span class="line"> <span class="keyword">if</span>(obj.a==<span class="literal">null</span>)&#123; &#125;</span><br><span class="line"><span class="comment">//  相当于：</span></span><br><span class="line"><span class="comment">// if (obj.a === null || obj.a === undefined) &#123;&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>if语句和逻辑运算</strong></p>
<p>truly变量：!!a===true的变量<br>falsely变量：!!a===false的变量</p>
<p><img src="/images/20204/jsreview-05.png" alt="falsely变量"></p>
<p><img src="/images/20204/jsreview-06.png" alt="falsely变量"></p>
<p>if语句判断的，实际上是<code>truly变量</code>和<code>falsely变量</code></p>
<p><strong>逻辑判断</strong></p>
<p><img src="/images/20204/jsreview-07.png" alt="逻辑判断"></p>
<h2 id="4、小结"><a href="#4、小结" class="headerlink" title="4、小结"></a>4、小结</h2><p><img src="/images/20204/jsreview-08.png" alt="小结"></p>
<h1 id="第五章、原型和原型链（必考）"><a href="#第五章、原型和原型链（必考）" class="headerlink" title="第五章、原型和原型链（必考）"></a>第五章、原型和原型链（必考）</h1><h2 id="1、前言"><a href="#1、前言" class="headerlink" title="1、前言"></a>1、前言</h2><ul>
<li>js本事是基于原型继承的语言。</li>
</ul>
<p>ES6之前写继承，只能是通过原型来继承，不像java一样，通过class来继承。<br>ES6之后，class也只是写法上的不同而已，真正的继承，还是原型链的继承。</p>
<p><strong>题目：</strong></p>
<ul>
<li>如何准确判断一个变量是不是数组？</li>
<li>手写一个简易的jQuery,考虑插件和扩展性</li>
<li>class的原型本质，怎么理解</li>
</ul>
<h2 id="2、class和继承"><a href="#2、class和继承" class="headerlink" title="2、class和继承"></a>2、class和继承</h2><p><strong>class</strong></p>
<ul>
<li>constructor</li>
<li>属性</li>
<li>方法</li>
</ul>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name,number)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name</span><br><span class="line">        <span class="keyword">this</span>.number=number</span><br><span class="line">    &#125;</span><br><span class="line">    sayHi()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(</span><br><span class="line">            <span class="string">`姓名：<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>,学号：<span class="subst">$&#123;<span class="keyword">this</span>.number&#125;</span>`</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// stydy()&#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过类声明对象/实例</span></span><br><span class="line"><span class="keyword">const</span> xialuo=<span class="keyword">new</span> Student(<span class="string">'夏洛'</span>,<span class="number">100</span>);</span><br><span class="line"><span class="built_in">console</span>.log(xialuo.name);</span><br><span class="line"><span class="built_in">console</span>.log(xialuo.number);</span><br><span class="line">xialuo.sayHi();</span><br></pre></td></tr></table></figure>
<p><strong>继承</strong></p>
<p>当我们的class中有可以共用的属性，就可以继承出来</p>
<ul>
<li>extends</li>
<li>super</li>
<li>扩展或重写方法</li>
</ul>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    eat() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>eat somthing`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name, number) &#123;</span><br><span class="line">        <span class="keyword">super</span>(name)</span><br><span class="line">        <span class="keyword">this</span>.number = number;</span><br><span class="line">    &#125;</span><br><span class="line">    sayHi() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`姓名 <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> ，学号<span class="subst">$&#123;<span class="keyword">this</span>.number&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> <span class="keyword">extends</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name, major) &#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">        <span class="keyword">this</span>.major = major;</span><br><span class="line">    &#125;</span><br><span class="line">    teach()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>教授 <span class="subst">$&#123;<span class="keyword">this</span>.major&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实例</span></span><br><span class="line"><span class="keyword">const</span> xialuo = <span class="keyword">new</span> Student(<span class="string">'夏洛'</span>, <span class="number">100</span>);</span><br><span class="line"><span class="built_in">console</span>.log(xialuo.name);</span><br><span class="line"><span class="built_in">console</span>.log(xialuo.number);</span><br><span class="line">xialuo.sayHi();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wanglaoshi =<span class="keyword">new</span> Teacher(<span class="string">'王老师'</span>,<span class="string">'语文'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(wanglaoshi.name)</span><br><span class="line"><span class="built_in">console</span>.log(wanglaoshi.major)</span><br><span class="line">wanglaoshi.teach();</span><br><span class="line">wanglaoshi.eat();</span><br></pre></td></tr></table></figure>
<h2 id="3、原型"><a href="#3、原型" class="headerlink" title="3、原型"></a>3、原型</h2><p><strong>类型判断-instanceof</strong></p>
<ul>
<li>可以判断引用类型</li>
<li>Object是所有class的父类</li>
</ul>
<p><img src="/images/20204/jsreview-09.png" alt="instanceof"></p>
<p><img src="/images/20204/jsreview-10.png" alt="instanceof"></p>
<p>typeof class 输出的function，继承本质上也是语法糖</p>
<p><img src="/images/20204/jsreview-11.png" alt="instanceof"></p>
<p>原型规则：</p>
<ul>
<li>每个class都有显示原型prototype</li>
<li>每个实例都有隐式原型<strong>proto</strong></li>
<li>实例的<strong>protp</strong>指向对应class的prototype</li>
</ul>
<p>基于原型的执行规则：</p>
<ul>
<li>获取属性xialuo.name或执行方法xialuo.sayHi()时</li>
<li>先在自身属性和方法寻找</li>
<li>如果找不到，自动去<strong>proto</strong>中查找</li>
</ul>
<h2 id="4、原型链"><a href="#4、原型链" class="headerlink" title="4、原型链"></a>4、原型链</h2><p><img src="/images/20204/jsreview-12.png" alt="原型链"></p>
<p><img src="/images/20204/jsreview-13.png" alt="原型链"></p>
<p>验证是否是本身的属性：</p>
<p><img src="/images/20204/jsreview-14.png" alt="验证是否是本身的属性"></p>
<p>hasOwnProperty从哪里来：</p>
<p><img src="/images/20204/jsreview-15.png" alt="hasOwnProperty从哪里来"></p>
<p>最终继承了Object。最好闭着眼睛把图画出来。</p>
<p><strong>再看instanceof</strong></p>
<p> instanceof会顺着原型链找。</p>
<p> 如：xialuo <code>instanceof</code> Student，<code>instanceof</code>前的变量（xialuo），顺着隐式原型一层一层往上找。</p>
<p> <strong>重要提示</strong></p>
<p> <img src="/images/20204/jsreview-16.png" alt="hasOwnProperty从哪里来"></p>
<h2 id="5、问题解答"><a href="#5、问题解答" class="headerlink" title="5、问题解答"></a>5、问题解答</h2><p> <img src="/images/20204/jsreview-17.png" alt="问题解答"></p>
<p><strong> 如何准确判断一个变量是数组</strong></p>
<blockquote>
<p>a instanceof Array</p>
</blockquote>
<p><strong>class的原型本质</strong></p>
<blockquote>
<p>原型和原型链的图示，最好自己画一遍图。<br>属性和方法的执行规则</p>
</blockquote>
<p><strong>手写简易jQuery 考虑插件和扩展性</strong></p>
<ul>
<li>jQuery基本实现，代码演示：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jQuery 基本结构</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">jQuery</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(selector) &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="built_in">document</span>.querySelectorAll(selector);</span><br><span class="line">        <span class="keyword">const</span> length=result.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">this</span>[i]=result[i]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.length=length;</span><br><span class="line">        <span class="keyword">this</span>.selector=selector;</span><br><span class="line">    &#125;</span><br><span class="line">    get(index)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>[index];</span><br><span class="line">    &#125;</span><br><span class="line">    each(fn)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="keyword">this</span>.length;i++)&#123;</span><br><span class="line">            <span class="keyword">const</span> elem=<span class="keyword">this</span>[i]</span><br><span class="line">            fn(elem)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    on(type,fn)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="function"><span class="params">elem</span>=&gt;</span>&#123;</span><br><span class="line">            elem.addEventListener(type,fn,<span class="literal">false</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 扩展很多 DOM API</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const $p=new jQuery('p')</span></span><br><span class="line"><span class="comment">// $p.get(1)</span></span><br><span class="line"><span class="comment">// $p.each((elem)=&gt;console.log(elem.nodeName))</span></span><br><span class="line"><span class="comment">// $p.on('click',()=&gt;alert('clicked'))</span></span><br></pre></td></tr></table></figure>
<p> <img src="/images/20204/jsreview-18.png" alt="代码演示"></p>
<ul>
<li>考虑插件和扩展性</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插件</span></span><br><span class="line">jQuery.prototype.dialog=<span class="function"><span class="keyword">function</span>(<span class="params">info</span>)</span>&#123;</span><br><span class="line">    alert(info)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复写（造轮子）</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myJQuery</span> <span class="keyword">extends</span> <span class="title">jQuery</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(selector)&#123;</span><br><span class="line">        <span class="keyword">super</span>(selector)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 扩展自己的方法</span></span><br><span class="line">    addClass(className)&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>小结</strong></p>
<p> <img src="/images/20204/jsreview-19.png" alt="小结"></p>
<h1 id="第六章-作用域和闭包"><a href="#第六章-作用域和闭包" class="headerlink" title="第六章 作用域和闭包"></a>第六章 作用域和闭包</h1><h2 id="1、作用域和自由变量"><a href="#1、作用域和自由变量" class="headerlink" title="1、作用域和自由变量"></a>1、作用域和自由变量</h2><p><strong>题目</strong></p>
<p> <img src="/images/20204/jsreview-20.png" alt="题目"></p>
<p> 可以试着写一下，主要看点击的时候弹出设么东西。</p>
<p> <img src="/images/20204/jsreview-21.png" alt="题目"></p>
<p><strong>知识点</strong></p>
<p> <img src="/images/20204/jsreview-22.png" alt="知识点"></p>
<p><strong>作用域</strong></p>
<p><img src="/images/20204/jsreview-23.png" alt="作用域"></p>
<p>作用域代表了某个变量的，合法的使用范围。比如a可以在第一个红框被使用，a1可以再第二个红框被使用。</p>
<p>如果想把a2放在红框外使用，就会报错。</p>
<p><img src="/images/20204/jsreview-24.png" alt="作用域"></p>
<ul>
<li>全局作用域：在全局都可以使用，如window对象，document对象等</li>
<li>函数作用域：只能在当前函数使用</li>
<li>块级作用域：如 if(){}里面定义的变量</li>
</ul>
<p><img src="/images/20204/jsreview-25.png" alt="作用域"></p>
<p><strong>自由变量</strong></p>
<p><img src="/images/20204/jsreview-26.png" alt="自由变量"></p>
<h2 id="2、闭包-closure"><a href="#2、闭包-closure" class="headerlink" title="2、闭包 closure"></a>2、闭包 closure</h2><p><img src="/images/20204/jsreview-27.png" alt="闭包"></p>
<p>总之，他函数定义的地方，和函数返回的地方，是不一样的，如下：</p>
<p><img src="/images/20204/jsreview-28.png" alt="闭包"></p>
<p>代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数作为返回值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> a=<span class="number">100</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(a)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fn=create()</span><br><span class="line"><span class="keyword">const</span> a=<span class="number">200</span></span><br><span class="line">fn() <span class="comment">// 100</span></span><br></pre></td></tr></table></figure>
<p>上面，自由变量a 创建的时候是在create里面创建的 ，console.log(a)里面，自由变量a寻找的时候，会向定义的地方去寻找，找到<code>const a = 100</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数作为参数被传递</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> a=<span class="number">200</span></span><br><span class="line">    fn()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> a=<span class="number">100</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a)</span><br><span class="line">&#125;</span><br><span class="line">print(fn);</span><br></pre></td></tr></table></figure>
<p>上方，fn在print函数里面被执行， fn定义的时候，他里面的a是个自由变量，应该向fn()上级作用域寻找，找到<code>const a = 100</code>;</p>
<blockquote>
<p>所有的（不止闭包）自由变量的查找，是<strong>在函数定义的地方</strong>，向上级作用域查找；不是在执行的地方！！</p>
</blockquote>
<h2 id="3、this"><a href="#3、this" class="headerlink" title="3、this"></a>3、this</h2><p><strong>this的使用场景</strong></p>
<p><img src="/images/20204/jsreview-29.png" alt="this使用场景"></p>
<p><img src="/images/20204/jsreview-30.png" alt="this使用场景"></p>
<blockquote>
<p>this的取值，<strong>是在函数执行的时候确定的</strong>，不是在函数定义的时候确定的 </p>
</blockquote>
<p>第1、2种使用场景：</p>
<p><img src="/images/20204/jsreview-31.png" alt="使用场景1、2"></p>
<p>上面，不同于<code>call</code>,<code>bind</code>会返回新的函数，需要被重新调用。</p>
<p><img src="/images/20204/jsreview-32.png" alt="使用场景3"></p>
<p>上图左边，<code>setTimeout</code>里的函数，被当做普通函数被执行。他是通过<code>setTimeout</code>被执行，并不是通过<code>zhangsan.sayHi()</code>被执行</p>
<p>上图右边，如果有箭头函数，箭头函数的<code>this</code>取上级作用域的<code>this</code>（箭头函数没有单独作用域），</p>
<p><img src="/images/20204/jsreview-33.png" alt="使用场景3"></p>
<h2 id="4、题目解答"><a href="#4、题目解答" class="headerlink" title="4、题目解答"></a>4、题目解答</h2><ul>
<li>this的不同应用场景，如何取值？</li>
<li>实际开发中闭包的应用场景，举例说明</li>
<li>手写bind函数</li>
</ul>
<p>bind用法：</p>
<p><img src="/images/20204/jsreview-36.png" alt="题目解答"></p>
<p>手写bind函数：</p>
<p><img src="/images/20204/jsreview-34.png" alt="题目解答"></p>
<p>上图，fn1的<code>bind</code>，来自于Function。</p>
<p><img src="/images/20204/jsreview-35.png" alt="来自于Function"></p>
<h2 id="5、实际开发中闭包的应用"><a href="#5、实际开发中闭包的应用" class="headerlink" title="5、实际开发中闭包的应用"></a>5、实际开发中闭包的应用</h2><ul>
<li>隐藏数据</li>
<li>如：做一个简单的cache工具</li>
</ul>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 闭包隐藏数据，只提供 API</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createCache</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> data = &#123;&#125; <span class="comment">// 闭包中的数据，被隐藏，不被外界访问</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        set: <span class="function"><span class="keyword">function</span> (<span class="params">key, val</span>) </span>&#123;</span><br><span class="line">            data[key] = val</span><br><span class="line">        &#125;,</span><br><span class="line">        get: <span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> data[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> c = createCache()</span><br><span class="line">c.set(<span class="string">'a'</span>, <span class="number">100</span>)</span><br><span class="line"><span class="built_in">console</span>.log( c.get(<span class="string">'a'</span>) )</span><br></pre></td></tr></table></figure>
<p>上述函数里面，我们把数据隐藏，只提供api,数据可以自己管理。</p>
<p><strong>创建10个<a>,点击弹出序号</strong></p>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!--如果i放在外层，那么每个a点击都弹出<span class="number">10</span>--&gt;</span><br><span class="line">&lt;!--事件在click的时候才被执行，此时<span class="keyword">for</span>循环已经完成。若i是全局变量，则i已经变成<span class="number">10</span>--&gt;</span><br><span class="line">&lt;!--故i需要为块级作用域--&gt;</span><br><span class="line"><span class="keyword">let</span> a</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>)</span><br><span class="line">    a.innerHTML = i + <span class="string">'&lt;br&gt;'</span></span><br><span class="line">    a.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">        e.preventDefault()</span><br><span class="line">        alert(i)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不会立即执行的变量，可能会被误导。</p>
<p><strong>小结</strong></p>
<p><img src="/images/20204/jsreview-37.png" alt="小结"></p>
<p><strong>其他</strong></p>
<p><img src="/images/20204/jsreview-38.png" alt="其他"></p>
<p>上图，通过调用隐式原型上的方法，会返回undefined，是由于this作用域的问题。</p>
<p>本质上，<code>xialuo</code>调用<code>sayHi()</code>，是通过<strong>类似于</strong><code>call()</code>这种方式实现的。</p>
<h1 id="第七章、异步和单线程"><a href="#第七章、异步和单线程" class="headerlink" title="第七章、异步和单线程"></a>第七章、异步和单线程</h1><p><strong>题目</strong></p>
<ul>
<li>同步和异步的区别是什么？</li>
<li>手写用 Promise加载一张图片</li>
<li>前端使用异步的场景有哪些</li>
</ul>
<p><img src="/images/20204/jsreview-39.png" alt="手写面试题目"></p>
<p>1、3、5、4、2</p>
<p><strong>知识点</strong></p>
<p><img src="/images/20204/jsreview-40.png" alt="手写面试题目"></p>
<h2 id="同步和异步的区别"><a href="#同步和异步的区别" class="headerlink" title="同步和异步的区别"></a>同步和异步的区别</h2><p><strong>单线程和异步</strong></p>
<p><img src="/images/20204/jsreview-41.png" alt="单线程和异步"></p>
<p>通俗来讲，js只能同时做一件事。</p>
<p>异步是由于单线程的背景而来的，并不是说，为了异步而异步。</p>
<p><img src="/images/20204/jsreview-42.png" alt="单线程和异步"></p>
<p>异步是为了解决单线程等待的问题。如请求接口的时候需要1秒钟，那么这一秒钟不能卡住</p>
<p><img src="/images/20204/jsreview-43.png" alt="异步和同步"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 异步 （callback 回调函数）</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">100</span>)</span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">200</span>)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">300</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">100</span>)</span><br><span class="line">alert(<span class="number">200</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p>如上，每个异步都会有个回调函数，执行完同步任务后，再执行回调函数</p>
<ul>
<li>异步和同步是基于JS是单线程语言</li>
<li>异步不会阻塞代码执行</li>
<li>同步会</li>
</ul>
<h2 id="异步的应用场景"><a href="#异步的应用场景" class="headerlink" title="异步的应用场景"></a>异步的应用场景</h2><p>其实就是一些等待的场景：</p>
<p>若没有这些需要等待的场景，js根本不需要异步。</p>
<ul>
<li>网络请求，如ajax图片加载</li>
<li>定时任务，如setTimeout</li>
</ul>
<p>网络请求：</p>
<p><img src="/images/20204/jsreview-44.png" alt="网络请求"></p>
<p>图片加载：</p>
<p><img src="/images/20204/jsreview-45.png" alt="网络请求"></p>
<p>定时器：</p>
<p><img src="/images/20204/jsreview-46.png" alt="网络请求"></p>
<h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><p><strong>callback hell</strong></p>
<p><img src="/images/20204/jsreview-47.png" alt="callback"></p>
<p>如上图：之前的方式一直是被人所诟病的，“回调地狱，越陷越深”。</p>
<p>早期nodejs的研发，没有支持promise，这种情况就很多。</p>
<p><strong>Promise</strong></p>
<p>语法：</p>
<p><img src="/images/20204/jsreview-48.png" alt="callback"></p>
<p>成功的时候调用resolve,失败时调用reject。可以触发then和catch。</p>
<p>连续用法：</p>
<p><img src="/images/20204/jsreview-49.png" alt="callback"></p>
<p>如上图：写法更加简洁，管道形式，不是嵌套形式。他还是一种callback形式，变成了非嵌套的形式。</p>
<h2 id="问题解答"><a href="#问题解答" class="headerlink" title="问题解答"></a>问题解答</h2><p><strong>同步和异步的区别</strong></p>
<p>上面说过了。</p>
<p><strong>手写Promise加载图片</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(</span><br><span class="line">        <span class="comment">// new Promise传入一个参数，这个参数是个函数</span></span><br><span class="line">        (resolve, reject) =&gt; &#123;</span><br><span class="line">            <span class="comment">// resolve,reject这两个参数也是函数</span></span><br><span class="line">            <span class="keyword">const</span> img = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>)</span><br><span class="line">            img.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                resolve(img)</span><br><span class="line">            &#125;</span><br><span class="line">            img.onerror = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> err = <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`图片加载失败 <span class="subst">$&#123;src&#125;</span>`</span>)</span><br><span class="line">                reject(err)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 触发图片加载。加载成功之后就会触发onload()，调用resolve</span></span><br><span class="line">            img.src = src</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">'https://img.mukewang.com/5a9fc8070001a82402060220-140-140.jpg'</span></span><br><span class="line">loadImg(url).then(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// then里面传函数，接收成功的对象</span></span><br><span class="line">    <span class="built_in">console</span>.log(img.width)</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line">&#125;).then(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 可以接着then，接收上个then return 的普通对象</span></span><br><span class="line">    <span class="comment">// 如果上个then，return的是一个Promise实例，接收的就是resolve。如下个示例;</span></span><br><span class="line">    <span class="built_in">console</span>.log(img.height)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">ex</span> =&gt;</span> <span class="built_in">console</span>.error(ex))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> url1 = <span class="string">'https://img.mukewang.com/5a9fc8070001a82402060220-140-140.jpg'</span></span><br><span class="line"><span class="keyword">const</span> url2 = <span class="string">'https://img3.mukewang.com/5a9fc8070001a82402060220-100-100.jpg'</span></span><br><span class="line">loadImg(url1).then(<span class="function"><span class="params">img1</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(img1.width)</span><br><span class="line">    <span class="keyword">return</span> img1 <span class="comment">// 普通对象</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">img1</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(img1.height)</span><br><span class="line">    <span class="keyword">return</span> loadImg(url2) <span class="comment">// promise 实例</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">img2</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(img2.width)</span><br><span class="line">    <span class="keyword">return</span> img2</span><br><span class="line">&#125;).then(<span class="function"><span class="params">img2</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(img2.height)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">ex</span> =&gt;</span> <span class="built_in">console</span>.error(ex))</span><br></pre></td></tr></table></figure>
<p><strong>异步应用场景</strong></p>
<p>上面说过了</p>
<p><strong>小结</strong></p>
<p><img src="/images/20204/jsreview-50.png" alt="小结"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h1 id="第八章、JS异步进阶"><a href="#第八章、JS异步进阶" class="headerlink" title="第八章、JS异步进阶"></a>第八章、JS异步进阶</h1><h2 id="8-1、考点简介"><a href="#8-1、考点简介" class="headerlink" title="8-1、考点简介"></a>8-1、考点简介</h2><ul>
<li>event loop</li>
<li>promise进阶</li>
<li>asyns/await</li>
<li>微任务/宏任务</li>
</ul>
<h2 id="8-2、部分面试题"><a href="#8-2、部分面试题" class="headerlink" title="8-2、部分面试题"></a>8-2、部分面试题</h2><ul>
<li>请描述 event loop （事件循环/事件轮询）的机制，可画图</li>
<li>什么事宏任务和微任务，两者有什么区别？</li>
<li>Promise 有哪三种状态？如何变化？</li>
<li>场景题<ul>
<li>promise then 和 catch 的连接 </li>
<li>async/await 语法</li>
<li>promise 和 setTimeout 的顺序</li>
<li>外加 async/await 的顺序问题</li>
</ul>
</li>
</ul>
<h2 id="8-3、什么事-event-loop-（事件循环-事件轮询）"><a href="#8-3、什么事-event-loop-（事件循环-事件轮询）" class="headerlink" title="8-3、什么事 event loop （事件循环/事件轮询）"></a>8-3、什么事 event loop （事件循环/事件轮询）</h2><ul>
<li>JS是单线程运行的</li>
<li>异步要基于回调来实现</li>
<li>enent loop 就是JS异步回调的实现原理</li>
</ul>
<p><strong>JS 如何执行？</strong></p>
<blockquote>
<p>JS是从前到后，一行一行执行的，如果某一行执行报错，则停止下面代码的执行。先把同步代码执行完，再执行异步</p>
</blockquote>
<p>我们有如下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'Hi'</span>)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">cb1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'cb1'</span>)</span><br><span class="line">&#125;,<span class="number">5000</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Bye'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/images/20204/jsreview-51.png" alt="代码演示"></p>
<p>如上图：</p>
<ul>
<li>左侧 Browser console 是模拟 浏览器的 Console ，</li>
<li>右侧的几个是在JS引擎里面的模块，<ul>
<li>Call Stack： 调用栈，</li>
<li>Web APIs：指浏览器运行环境对一下API的定义，比如setTimeout或DOM/BOM，ES规范里面是没有的，而是浏览器定义的，</li>
<li>Event Loop</li>
<li>Callback Queue :回调函数的队列</li>
</ul>
</li>
</ul>
<p>我们开始执行第一行代码<code>console.log(&#39;Hi&#39;)</code>：会把它推入调用栈，然后调用栈执行，控制台输出“H1”。执行完毕后，会清空调用栈：</p>
<p><img src="/images/20204/jsreview-52.png" alt="执行第一行"></p>
<p>执行第二行代码：他是一个<code>setTimeout</code>函数，有两个参数，分别是函数<code>cb1</code>和延迟时间<code>5s</code>，但是暂时执行不到<code>console.log(&#39;cb1&#39;)</code>。</p>
<p><code>setTimeout</code>函数是浏览器定义的，执行时，会把函数放到“定时器”（浏览器自带）里面，延时5秒钟；5秒钟之后，定时器会把<code>cb1</code>放在<code>Callback Queue</code>里面：</p>
<p><img src="/images/20204/jsreview-53.png" alt="setTimeout"></p>
<p>执行第三行时，和第一行相同，控制台输出<code>Bye</code>。同步代码执行完毕之后，<code>Call Stack</code>就空了，此时浏览器内核会启动<code>EventLoop</code>机制，会寻找有没有需执行的代码：</p>
<p><img src="/images/20204/jsreview-54.png" alt="执行第三行时"></p>
<p>5秒之后，定时器会把<code>cb1</code>放在<code>Callback Queue</code>里面：</p>
<p><img src="/images/20204/jsreview-55.png" alt="EventLoop"></p>
<p>此时<code>Event Loop</code>就会发现<code>cb1</code>，并把它拿到 <code>Call Stack</code>里：</p>
<p><img src="/images/20204/jsreview-56.png" alt="拿到 `Call Stack`里"></p>
<p>然后执行<code>cb1</code>里面的内容：</p>
<p><img src="/images/20204/jsreview-57.png" alt="执行`cb1`里面的内容"></p>
<p>执行之后，清空 Call Stack ，整个代码执行完毕：</p>
<p><img src="/images/20204/jsreview-58.png" alt="最后清空 Call Stack"></p>
<hr>
<p><strong>总结：event loop 过程</strong></p>
<ul>
<li>同步代码，一行一行放在 Call Stack 执行</li>
<li>遇到异步，会先“记录”下，等待时机（定时、网络请求等）</li>
<li>时机到了，就移动到 Callback Queue</li>
<li>如 Call Stack 为空（即同步代码执行完）Event Loop 开始工作</li>
<li>轮询查找 Callback Queue，如有则移动到 Call Stack 执行</li>
<li>然后轮询查找（永动机一样）</li>
</ul>
<h2 id="8-5、DOM-事件和-event-loop"><a href="#8-5、DOM-事件和-event-loop" class="headerlink" title="8-5、DOM 事件和 event loop"></a>8-5、DOM 事件和 event loop</h2><p><img src="/images/20204/jsreview-59.png" alt="DOM 事件和 event loop"></p>
<p>如上右图，点击的时候才打印’button clicked’。</p>
<p>执行到 <code>$(&#39;#btn1&#39;).click()</code>的时候会先把回调函数放到 <code>Web APIs</code>里面，用户点击的时候再放到<code>Callback Queue</code>里，基于 <code>event loop</code>的机制就会执行。</p>
<ul>
<li>JS是单线程的</li>
<li>异步（setTimeout，ajax等）使用回调，基于event loop</li>
<li>DOM 事件也使用回调，基于 event loop</li>
<li>DOM 事件不是异步</li>
</ul>
<h2 id="8-6-Promise-有哪三种状态"><a href="#8-6-Promise-有哪三种状态" class="headerlink" title="8-6 Promise 有哪三种状态"></a>8-6 Promise 有哪三种状态</h2><ul>
<li>三种状态</li>
<li>状态的表现和变化</li>
<li>then 和 catch 对状态的影响</li>
</ul>
<p>之前我们用Promise演示了图片加载，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(</span><br><span class="line">        <span class="comment">// new Promise传入一个参数，这个参数是个函数</span></span><br><span class="line">        (resolve, reject) =&gt; &#123;</span><br><span class="line">            <span class="comment">// resolve,reject这两个参数也是函数</span></span><br><span class="line">            <span class="keyword">const</span> img = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>)</span><br><span class="line">            img.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                resolve(img)</span><br><span class="line">            &#125;</span><br><span class="line">            img.onerror = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> err = <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`图片加载失败 <span class="subst">$&#123;src&#125;</span>`</span>)</span><br><span class="line">                reject(err)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 触发图片加载。加载成功之后就会触发onload()，调用resolve</span></span><br><span class="line">            img.src = src</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">'https://img.mukewang.com/5a9fc8070001a82402060220-140-140.jpg'</span></span><br><span class="line">loadImg(url).then(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(img.width)</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line">&#125;).then(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(img.height)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">ex</span> =&gt;</span> <span class="built_in">console</span>.error(ex))</span><br></pre></td></tr></table></figure>
<p><strong>三种状态</strong></p>
<ul>
<li>pending resolved rejected</li>
<li>pending -&gt; resolved 或 pending -&gt; rejected</li>
<li>变化不可逆</li>
</ul>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 刚定义时，状态默认为 pending</span></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 resolve() 后，状态变成 resolved</span></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        resolve()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 reject() 后，状态变成 rejected</span></span><br><span class="line"><span class="keyword">const</span> p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        reject()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>状态的表现和变化</strong></p>
<ul>
<li>pending 状态，不会触发 then 和 catch</li>
<li>resolved 状态，会触发后续的 then 回调函数 ，不能触发catch（写了也不会执行）</li>
<li>rejected 状态，会触发后续的 catch 回调函数 ，不能触发then（写了也不会执行）</li>
</ul>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 直接返回一个 resolved 状态</span></span><br><span class="line"><span class="keyword">const</span> p1=<span class="built_in">Promise</span>.resolve(<span class="number">100</span>)</span><br><span class="line">p1.then(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'data'</span>,data)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.error(<span class="string">'err'</span>,err) <span class="comment">// 不会触发</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 直接返回一个 rejected 状态</span></span><br><span class="line"><span class="keyword">const</span> p2=<span class="built_in">Promise</span>.reject(<span class="string">'some error'</span>)</span><br><span class="line">p2.then(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'data'</span>,data) <span class="comment">// 不会触发</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.error(<span class="string">'err'</span>,err) </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="8-7、-Promise-的-then-和-catch-如何影响状态变化"><a href="#8-7、-Promise-的-then-和-catch-如何影响状态变化" class="headerlink" title="8-7、 Promise 的 then 和 catch 如何影响状态变化"></a>8-7、 Promise 的 then 和 catch 如何影响状态变化</h2><p>then catch 会继续返回 Promise ，<strong>此时可能会发生状态变化！！！</strong></p>
<ul>
<li>then 正常返回 resolved ，里面有报错则返回 rejected</li>
<li>cath 正常返回 resolved ，里面有报错则返回 rejected</li>
</ul>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// then() 一般正常返回 resolved 状态的 promise</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">100</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// then() 里抛出错误，会返回 rejected 状态的 promise</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'err'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// catch() 不抛出错误，会返回 resolved 状态的 promise ！！！</span></span><br><span class="line"><span class="built_in">Promise</span>.reject().catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(<span class="string">'catch some error'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// catch() 抛出错误，会返回 rejected 状态的 promise</span></span><br><span class="line"><span class="built_in">Promise</span>.reject().catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(<span class="string">'catch some error'</span>)</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'err'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="8-8、Promise-关于-then-和-catch-的面试题"><a href="#8-8、Promise-关于-then-和-catch-的面试题" class="headerlink" title="8-8、Promise 关于 then 和 catch 的面试题"></a>8-8、Promise 关于 then 和 catch 的面试题</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一题  1 3</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二题 1 2 3</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 返回 rejected 状态的 promise</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>) </span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'erro1'</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 返回 resolved 状态的 promise</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第三题 1 2</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 返回 rejected 状态的 promise</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'erro1'</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 返回 resolved 状态的 promise</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>总结</strong></p>
<ul>
<li>三种状态，状态的表现和变化</li>
<li>then 和 catch 对状态的影响</li>
<li>then 和 catch 的链式调用</li>
</ul>
<h2 id="8-9、async-await语法介绍（一）"><a href="#8-9、async-await语法介绍（一）" class="headerlink" title="8-9、async-await语法介绍（一）"></a>8-9、async-await语法介绍（一）</h2><p>背景：</p>
<ul>
<li>异步回调 callback hell</li>
<li>Promise then catch 链式调用，但也是基于回调函数</li>
<li>async/await 是同步语法，彻底消灭回调函数。用同步的方式，编写异步。</li>
</ul>
<p>基本语法代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> img = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>)</span><br><span class="line">        img.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(img)</span><br><span class="line">        &#125;</span><br><span class="line">        img.onerror = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`图片加载失败 <span class="subst">$&#123;src&#125;</span>`</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        img.src = src</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> promise</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">loadImg1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> src1 = <span class="string">'http://www.imooc.com/static/img/index/logo_new.png'</span></span><br><span class="line">    <span class="keyword">const</span> img1 = <span class="keyword">await</span> loadImg(src1)</span><br><span class="line">    <span class="keyword">return</span> img1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">loadImg2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> src2 = <span class="string">'https://avatars3.githubusercontent.com/u/9583120'</span></span><br><span class="line">    <span class="keyword">const</span> img2 = <span class="keyword">await</span> loadImg(src2)</span><br><span class="line">    <span class="keyword">return</span> img2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 我们定义匿名函数立马执行，因为执行 await 的时候必须有async 包裹</span></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 注意：await 必须放在 async 函数中，否则会报错</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 加载第一张图片</span></span><br><span class="line">        <span class="keyword">const</span> img1 = <span class="keyword">await</span> loadImg1()</span><br><span class="line">        <span class="built_in">console</span>.log(img1)</span><br><span class="line">        <span class="comment">// 加载第二张图片</span></span><br><span class="line">        <span class="keyword">const</span> img2 = <span class="keyword">await</span> loadImg2()</span><br><span class="line">        <span class="built_in">console</span>.log(img2)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ex) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(ex)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>await<code>后面你可以追加</code>Promise <code>对象，或者</code>async`函数</p>
</blockquote>
<h2 id="async-await-和-Promise-的关系"><a href="#async-await-和-Promise-的关系" class="headerlink" title="async/await 和 Promise 的关系"></a>async/await 和 Promise 的关系</h2><p>async/await 是消灭异步回调的终极武器，但和 Promise 并不互斥，反而两者相辅相成</p>
<ul>
<li>执行async 函数返回结果都是 Promise 对象<ul>
<li>（如果函数内没返回 Promise ，则自动封装一下）</li>
</ul>
</li>
<li>await 相当于 Promise 的 then</li>
<li>try…catch 可捕获异常，代替了 Promise 的 catch</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log( fn2() )</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 执行 async 函数， 返回的是一个 Promise 对象</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">100</span>  <span class="comment">// 相当于 return Promise.resolve(100)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log( fn1() )</span><br></pre></td></tr></table></figure>
<ul>
<li>await 后面跟 Promise 对象：会阻断后续代码，等待状态变为 resolved ，才获取结果并继续执行<ul>
<li>后面跟 async 函数，相当于后面跟Promise</li>
</ul>
</li>
<li>await 后续跟非 Promise 对象：会直接返回<ul>
<li>如后面跟静态值</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、后跟 Promise 对象</span></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> p2 = <span class="built_in">Promise</span>.resolve(<span class="number">100</span>)</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> p2 <span class="comment">// await 相当于 Promise then</span></span><br><span class="line">    <span class="built_in">console</span>.log(res) <span class="comment">// 100</span></span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2、后跟值</span></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="number">100</span> </span><br><span class="line">    <span class="comment">// await 后续跟非 Promise 对象：会直接返回 </span></span><br><span class="line">    <span class="comment">// 相当于 Promise.resolve(100)</span></span><br><span class="line">    <span class="built_in">console</span>.log(res) <span class="comment">// 100</span></span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3、后跟 async 函数</span></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> fn1 </span><br><span class="line">    <span class="built_in">console</span>.log(res) <span class="comment">// 100</span></span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 状态变为 resolved 才获取结果并继续执行</span></span><br><span class="line">!(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;)</span><br><span class="line">    <span class="keyword">await</span> p1</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'p1'</span>) <span class="comment">// 不会执行</span></span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> p3 = <span class="built_in">Promise</span>.reject(<span class="string">'some err'</span>)</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> p3</span><br><span class="line">    <span class="built_in">console</span>.log(res) <span class="comment">// 不会执行</span></span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<ul>
<li>try…catch 捕获 rejected 状态</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> p4 = <span class="built_in">Promise</span>.reject(<span class="string">'some err'</span>)  <span class="comment">// rejected 状态</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> p4</span><br><span class="line">        <span class="built_in">console</span>.log(res)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ex) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(ex)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<p>总结来看：</p>
<ul>
<li>async 封装 Promise</li>
<li>await 处理 Promise 成功</li>
<li>try…catch 处理 Promise 失败</li>
</ul>
<h2 id="8-11-、异步的本质-async-await-是语法糖，异步本质还是回调函数"><a href="#8-11-、异步的本质-async-await-是语法糖，异步本质还是回调函数" class="headerlink" title="8-11 、异步的本质 - async/await 是语法糖，异步本质还是回调函数"></a>8-11 、异步的本质 - async/await 是语法糖，异步本质还是回调函数</h2><ul>
<li>async/await 是消灭异步回调的终极武器</li>
<li>JS还是单线程，还得是有异步，还得是基于 event loop</li>
<li>async/await 只是一个语法糖，但这颗糖真香</li>
</ul>
<p>题目：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async1 start'</span>); <span class="comment">//2 重要</span></span><br><span class="line">    <span class="keyword">await</span> async2() <span class="comment">// undefined</span></span><br><span class="line">    <span class="comment">// await 的后面，都可以看做是 callback 里的内容，即异步</span></span><br><span class="line">    <span class="comment">// 类似于 event loop ，setTimeout(cb1)</span></span><br><span class="line">    <span class="comment">// 比如是：setTimeout(function()&#123;console.log('async1 end')&#125;)</span></span><br><span class="line">    <span class="comment">// 或者是：Promise.resolve().then(()=&gt;&#123;console.log('async1 end')&#125;)  // 微任务/宏任务</span></span><br><span class="line">    <span class="comment">// 总之下面的是用异步执行的！！</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async1 end'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async2'</span>) <span class="comment">// 3 重要</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script start'</span>)  <span class="comment">// 1</span></span><br><span class="line">async1()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script end'</span>)</span><br></pre></td></tr></table></figure>
<p>我们把上面题目改变一下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async1 start'</span>); <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">await</span> async2()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 下面三行都是异步回调 callback 内容</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async1 end'</span>) <span class="comment">//5</span></span><br><span class="line">    <span class="keyword">await</span> async3()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 下面一行是异步回调的内容</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'async1 end 2'</span>)  <span class="comment">// 7</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async2'</span>) <span class="comment">// 3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async3</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async3'</span>) <span class="comment">// 6</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script start'</span>)  <span class="comment">// 1</span></span><br><span class="line">async1()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script end'</span>) <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>即，只要遇到了 <code>await</code> ，后面的代码都相当于放在 callback 里。</p>
</blockquote>
<h2 id="8-12、-for-of-的应用场景"><a href="#8-12、-for-of-的应用场景" class="headerlink" title="8-12、 for-of 的应用场景"></a>8-12、 for-of 的应用场景</h2><ul>
<li>for … in （以及 forEach for）是常规的同步遍历</li>
<li>for … of 常用于异步的遍历</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定时算乘法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">multi</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(num * num)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 forEach ，是 1s 之后打印出所有结果，即 3 个值是一起被计算出来的</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">    nums.forEach(<span class="keyword">async</span> x =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> multi(x);</span><br><span class="line">        <span class="built_in">console</span>.log(res);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">test1();</span><br></pre></td></tr></table></figure>
<p>使用 for…of ，可以让计算挨个串行执行</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test2</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> nums) &#123;</span><br><span class="line">        <span class="comment">// 在 for...of 循环体的内部，遇到 await 会挨个串行计算</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> multi(x)</span><br><span class="line">        <span class="built_in">console</span>.log(res)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">test2()</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>async/await 总结</strong></p>
<ul>
<li>async/await 解决了异步回调，是一个很香的语法糖</li>
<li>async/await 和 Promise 的关系，重要！</li>
<li>for…of 的使用</li>
</ul>
<h2 id="8-13、宏任务和微任务"><a href="#8-13、宏任务和微任务" class="headerlink" title="8-13、宏任务和微任务"></a>8-13、宏任务和微任务</h2><p><strong>宏任务 macroTask 和微任务 microTask</strong></p>
<p>是异步api里面的概念，主要内容：</p>
<ul>
<li>什么是宏任务，什么是微任务</li>
<li>event loop 和 DOM 渲染</li>
<li>微任务和宏任务的区别</li>
</ul>
<p>简介：</p>
<ul>
<li>宏任务：setTimeout setInterval Ajax DOM 事件</li>
<li>微任务：Promise async/await（对于前端来说）</li>
<li>微任务比宏任务执行的更早</li>
</ul>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">100</span>)</span><br><span class="line"><span class="comment">// 宏任务</span></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">200</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 微任务</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">300</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">400</span>)</span><br><span class="line"><span class="comment">// 100 400 300 200</span></span><br></pre></td></tr></table></figure>
<h2 id="8-14-event-loop-和-DOM-渲染的关系"><a href="#8-14-event-loop-和-DOM-渲染的关系" class="headerlink" title="8-14 event-loop 和 DOM 渲染的关系"></a>8-14 event-loop 和 DOM 渲染的关系</h2><ul>
<li>再次回归一遍 event loop 的过程</li>
<li>JS 是单线程的，而且和 DOM 渲染共用一个线程</li>
<li>JS 执行的时候，要留一些时机供 DOM 渲染</li>
</ul>
<p><strong>再次回顾 event loop 的过程</strong></p>
<p><img src="/images/20204/jsreview-60.png" alt="event loop 的过程"></p>
<ul>
<li>每一次 call stack 结束，都会触发 DOM 渲染（不一定非得渲染，就是给一次 DOM 渲染的机会！！！）</li>
<li>然后再进行 event loop</li>
</ul>
<h2 id="8-15、为什么微任务比宏任务执行更早"><a href="#8-15、为什么微任务比宏任务执行更早" class="headerlink" title="8-15、为什么微任务比宏任务执行更早"></a>8-15、为什么微任务比宏任务执行更早</h2><ul>
<li>每次 Call Stack 清空（即每次轮询结束），即同步任务执行完</li>
<li>都给 DOM 重新渲染的机会，DOM 结构如有改变则重新渲染</li>
<li>然后再去触发下一次 Event Loop</li>
</ul>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> $p1 = $(<span class="string">'&lt;p&gt;一段文字&lt;/p&gt;'</span>)</span><br><span class="line"><span class="keyword">const</span> $p2 = $(<span class="string">'&lt;p&gt;一段文字&lt;/p&gt;'</span>)</span><br><span class="line"><span class="keyword">const</span> $p3 = $(<span class="string">'&lt;p&gt;一段文字&lt;/p&gt;'</span>)</span><br><span class="line">$(<span class="string">'#container'</span>)</span><br><span class="line">            .append($p1)</span><br><span class="line">            .append($p2)</span><br><span class="line">            .append($p3)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'length'</span>,  $(<span class="string">'#container'</span>).children().length )</span><br><span class="line">alert(<span class="string">'本次 call stack 结束，DOM 结构已更新，但尚未触发渲染'</span>)</span><br><span class="line"><span class="comment">// （alert 会阻断 js 执行，也会阻断 DOM 渲染，便于查看效果）</span></span><br><span class="line"><span class="comment">// 到此，即本次 call stack 结束后（同步任务都执行完了），浏览器会自动触发渲染，不用代码干预</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 另外，按照 event loop 触发 DOM 渲染时机，setTimeout 时 alert ，就能看到 DOM 渲染后的结果了</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'setTimeout 是在下一次 Call Stack ，就能看到 DOM 渲染出来的结果了'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>微任务和宏任务的区别</strong></p>
<ul>
<li>宏任务：DOM 渲染后触发，如 setTimeout</li>
<li>微任务：DOM 渲染前触发，如 Promise</li>
</ul>
<p>代码演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改 DOM</span></span><br><span class="line"><span class="keyword">const</span> $p1 = $(<span class="string">'&lt;p&gt;一段文字&lt;/p&gt;'</span>)</span><br><span class="line"><span class="keyword">const</span> $p2 = $(<span class="string">'&lt;p&gt;一段文字&lt;/p&gt;'</span>)</span><br><span class="line"><span class="keyword">const</span> $p3 = $(<span class="string">'&lt;p&gt;一段文字&lt;/p&gt;'</span>)</span><br><span class="line">$(<span class="string">'#container'</span>)</span><br><span class="line">    .append($p1)</span><br><span class="line">    .append($p2)</span><br><span class="line">    .append($p3)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 微任务：渲染之前执行（DOM 结构已更新）</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> length = $(<span class="string">'#container'</span>).children().length</span><br><span class="line">    alert(<span class="string">`micro task <span class="subst">$&#123;length&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 宏任务：渲染之后执行（DOM 结构已更新）</span></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> length = $(<span class="string">'#container'</span>).children().length</span><br><span class="line">    alert(<span class="string">`macro task <span class="subst">$&#123;length&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="8-16、微任务和宏任务的根本区别"><a href="#8-16、微任务和宏任务的根本区别" class="headerlink" title="8-16、微任务和宏任务的根本区别"></a>8-16、微任务和宏任务的根本区别</h2><p>正常流程：</p>
<p><img src="/images/20204/jsreview-61.png" alt="event loop 的过程"></p>
<p>如果遇到 <code>Promise</code> ，会放到 <code>micro task queue 里</code>，而不是 <code>Web APIs</code></p>
<p><img src="/images/20204/jsreview-62.png" alt="event loop 的过程"></p>
<p>再深入思考一下：为何两者会有以上区别，一个在渲染前，一个在渲染后？</p>
<ul>
<li>微任务：ES 语法标准之内，<ul>
<li>JS 引擎来统一处理</li>
<li>即，不用浏览器有任何关于，即可一次性处理完，更快更及时。</li>
</ul>
</li>
<li>宏任务：是由浏览器规定的<ul>
<li>ES 语法没有，JS 引擎不处理，浏览器（或 nodejs）干预处理。</li>
</ul>
</li>
</ul>
<p>所以执行顺序是这样的</p>
<p><img src="/images/20204/jsreview-63.png" alt="event loop 的过程"></p>
<p><strong>微任务和宏任务 - 总结</strong></p>
<ul>
<li>宏任务有哪些？微任务有哪些？微任务触发时机更早</li>
<li>微任务、宏任务和 DOM 渲染的关系</li>
<li>微任务、宏任务和 DOM 渲染，在 event loop 过程</li>
</ul>
<h2 id="8-17、解答-JS-异步的面试题"><a href="#8-17、解答-JS-异步的面试题" class="headerlink" title="8-17、解答 JS 异步的面试题"></a>8-17、解答 JS 异步的面试题</h2><p><strong>描述 event loop 机制（可画图）</strong></p>
<ul>
<li>自行回顾event loop 的过程</li>
<li>和 DOM 渲染的关系</li>
<li>微任务和宏任务在 event loop 过程中的不同处理</li>
</ul>
<p><strong>什么事宏任务和微任务，两者区别</strong></p>
<ul>
<li>宏任务：setTimeout setInterval Ajax DOM 事件</li>
<li>微任务：Promise async/await（对于前端来说）</li>
<li>最主要区别：微任务比宏任务执行的更早<ul>
<li>宏任务：DOM 渲染后触发，</li>
<li>微任务：DOM 渲染前触发，</li>
<li>为什么？<ul>
<li>微任务：ES 语法标准之内，<ul>
<li>JS 引擎来统一处理</li>
<li>即，不用浏览器有任何关于，即可一次性处理完，更快更及时。</li>
</ul>
</li>
<li>宏任务：是由浏览器规定的<ul>
<li>ES 语法没有，JS 引擎不处理，浏览器（或 nodejs）干预处理。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Promise 的三种状态，如何变化</strong></p>
<ul>
<li>pending resolved rejected</li>
<li>pending -&gt; resolved 或 pending -&gt; rejected</li>
<li>变化不可逆<ul>
<li>pending 状态，不会触发 then 和 catch</li>
<li>resolved 状态，会触发后续的 then 回调函数 ，不能触发catch（写了也不会执行）</li>
<li>rejected 状态，会触发后续的 catch 回调函数 ，不能触发then（写了也不会执行）</li>
</ul>
</li>
</ul>
<p><strong>场景题 - promise then 和 catch 的连接</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一题  1 3</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二题 1 2 3</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 返回 rejected 状态的 promise</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>) </span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'erro1'</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 返回 resolved 状态的 promise</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第三题 1 2</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 返回 rejected 状态的 promise</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'erro1'</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 返回 resolved 状态的 promise</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>场景题 - async/await 语法</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">100</span></span><br><span class="line">&#125;</span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> a = fn() <span class="comment">// ??               // promise</span></span><br><span class="line">    <span class="keyword">const</span> b = <span class="keyword">await</span> fn() <span class="comment">// ??         // 100</span></span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'start'</span>)</span><br><span class="line">    <span class="keyword">const</span> a = <span class="keyword">await</span> <span class="number">100</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'a'</span>, a)</span><br><span class="line">    <span class="keyword">const</span> b = <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="number">200</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'b'</span>, b)</span><br><span class="line">    <span class="keyword">const</span> c = <span class="keyword">await</span> <span class="built_in">Promise</span>.reject(<span class="number">300</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'c'</span>, c)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'end'</span>)</span><br><span class="line">&#125;)() <span class="comment">// 执行完毕，打印出那些内容？</span></span><br></pre></td></tr></table></figure>
<p>如上左图， a 是个 Promise ；await 后面跟Promise，相当于 Promise.then()，故 b 是 100</p>
<p>如上右图，a 是 100 ，b 是 200 ，执行到 c 会报错</p>
<p><strong>场景题- promise 和 setTimeout 的顺序</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">100</span>)</span><br><span class="line"><span class="comment">// 宏任务</span></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">200</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 微任务</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">300</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">400</span>)</span><br><span class="line"><span class="comment">// 100 400 300 200</span></span><br></pre></td></tr></table></figure>
<p><strong>场景题 - async/await 的顺序问题</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'async1 start'</span>)</span><br><span class="line">  <span class="keyword">await</span> async2() <span class="comment">// 这一句会同步执行，返回 Promise ，其中的 `console.log('async2')` 也会同步执行</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'async1 end'</span>) <span class="comment">// 上面有 await ，下面就变成了“异步”，类似 cakkback 的功能（微任务）</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'async2'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script start'</span>)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 异步，宏任务</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'setTimeout'</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">async1()</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span> (<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123; <span class="comment">// 返回 Promise 之后，即同步执行完成，then 是异步代码</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'promise1'</span>) <span class="comment">// Promise 的函数体会立刻执行</span></span><br><span class="line">  resolve()</span><br><span class="line">&#125;).then (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 异步，微任务</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'promise2'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步代码执行完之后，屡一下现有的异步未执行的，按照顺序</span></span><br><span class="line"><span class="comment">// 1. async1 函数中 await 后面的内容 —— 微任务</span></span><br><span class="line"><span class="comment">// 2. setTimeout —— 宏任务</span></span><br><span class="line"><span class="comment">// 3. then —— 微任务</span></span><br></pre></td></tr></table></figure>
<h2 id="8-18、JS异步进阶-总结"><a href="#8-18、JS异步进阶-总结" class="headerlink" title="8-18、JS异步进阶 - 总结"></a>8-18、JS异步进阶 - 总结</h2><ul>
<li>event loop<ul>
<li>过程<ul>
<li>同步代码，一行一行放在 Call Stack 执行</li>
<li>遇到异步，会先“记录”下，等待时机（定时、网络请求等）</li>
<li>时机到了，就移动到 Callback Queue</li>
<li>如 Call Stack 为空（即同步代码执行完）Event Loop 开始工作</li>
<li>轮询查找 Callback Queue，如有则移动到 Call Stack 执行</li>
<li>然后轮询查找（永动机一样）</li>
</ul>
</li>
<li>DOM 事件和 event loop<ul>
<li>JS是单线程的</li>
<li>异步（setTimeout，ajax等）使用回调，基于event loop</li>
<li>DOM 事件也使用回调，基于 event loop</li>
<li>DOM 事件不是异步 </li>
</ul>
</li>
</ul>
</li>
<li>promise 进阶<ul>
<li>三种状态，状态的表现和变化</li>
<li>then 和 catch 对状态的影响</li>
<li>then 和 catch 的链式调用</li>
</ul>
</li>
<li>async/await<ul>
<li>async/await 解决了异步回调，是一个很香的语法糖</li>
<li>async/await 和 Promise 的关系，重要！</li>
<li>for…of 的使用</li>
</ul>
</li>
<li><p>微任务/宏任务</p>
<ul>
<li>宏任务有哪些？微任务有哪些？微任务触发时机更早</li>
<li>微任务、宏任务和 DOM 渲染的关系</li>
<li>微任务、宏任务和 DOM 渲染，在 event loop 过程</li>
</ul>
<h2 id="关于async-await、promise和setTimeout执行顺序"><a href="#关于async-await、promise和setTimeout执行顺序" class="headerlink" title="关于async/await、promise和setTimeout执行顺序"></a>关于async/await、promise和setTimeout执行顺序</h2></li>
</ul>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'async1 start'</span>);</span><br><span class="line">	<span class="keyword">await</span> async2();</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'asnyc1 end'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'async2'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script start'</span>);</span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'setTimeOut'</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line">async1();</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">reslove</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'promise1'</span>);</span><br><span class="line">	reslove();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'promise2'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script end'</span>);</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">script start</span><br><span class="line">async1 start</span><br><span class="line">async2</span><br><span class="line">promise1</span><br><span class="line">script end</span><br><span class="line">asnyc1 end</span><br><span class="line">promise2</span><br><span class="line">setTimeOut</span><br></pre></td></tr></table></figure>
	
		</div>
		
		<div id="current-post-cover" data-scr="../../../../../img/cart_cover.jpg"></div>

		<!-- relate post, comment...-->
		<div class="investment-container">
			<div class="investment-header">
				<div class="investment-title-1">
					<div class="on">相关文章</div>
					<div>评论</div>
					<div>分享</div>
				</div>
				<div class="investment-title-2">	            
					
	<span>
		<a id="totop-post-page">返回顶部</a>
		
			<a href="../../../19/20204/js-base-2/" title="web基础-2-web api、开发环境、运行环境" rel="prev">
				&laquo;上一篇
			</a>
		
		
			<a href="../../../09/20204/vue-qs/" title="万科社区、三亚中核园区项目--vue项目问题记录" rel="next">
				下一篇&raquo;
			</a>
			
	</span>


      		
				</div>	
			</div>
			
			<div class="investment-content">
				<div class="investment-content-list">
					

<div class="relate-post">
	
		<div class="config-info">
			Please check the parameter of <b>post_relate</b> in config.yml of hexo-theme-Annie! You should make sure that <b>postsEnable is true</b> and the number of site posts greater than 1.
		</div>	
	
</div>	
				</div>
				<div class="investment-content-list">
					<div class="layout-comment">

	

		

			<!-- gitalk comment -->
			<!-- show gitalk comment -->
<div id="gitalk-container"></div>

<!-- gitalk`s css & js -->
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<link rel="stylesheet" href="/css/comment.css">
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script type="text/javascript">

	(function gitalkComment(){
		//Thanks O-R
		//https://github.com/gitalk/gitalk/issues/102#issuecomment-382970552
		//去除尾部匹配正则数组的字符串  
		//Remove redundant characters
		String.prototype.trimEnd = function(regStr) {
			let result = this;
			if(regStr == undefined || regStr == null || regStr == "") {
				return result;
			}
			let array = regStr.split(',');

			if(array.length > 0) {

				let c = array.shift(), 
					str = this,
					i = str.length,
					rg = new RegExp(c),
					matchArr = str.match(rg);

				if(matchArr != undefined && matchArr != null && matchArr.length > 0) {
					let matchStr = matchArr[0].replace(/\\/g, "\\\\").replace(/\*/g, "\\*")
						.replace(/\+/g, "\\+").replace(/\|/g, "\\|")
						.replace(/\{/g, "\\{").replace(/\}/g, "\\}")
						.replace(/\(/g, "\\(").replace(/\)/g, "\\)")
						.replace(/\^/g, "\\^").replace(/\$/g, "\\$")
						.replace(/\[/g, "\\[").replace(/\]/g, "\\]")
						.replace(/\?/g, "\\?").replace(/\,/g, "\\,")
						.replace(/\./g, "\\.").replace(/\&/g, "\\&");
					matchStr = matchStr + '$';
					result = str.replace(new RegExp(matchStr), "");
				}

				if(array.length > 0) {
					return result.trimEnd(array.join())
				} else {
					return result;
				}
			}
		};

		//Create gitalk
		let gitalk = new Gitalk({
			clientID: '01919a648d33c758490c',
			clientSecret: 'b6b5eecd032ca01352b1e47aa08a580f86921929',
			//id: window.location.pathname,
			//id: decodeURI(window.location.pathname),
			//id: (window.location.pathname).split("/").pop().substring(0, 49),
			id: decodeURI( md5( location.href.trimEnd('#.*$,\\?.*$,index.html$') ) ),
			repo: 'Blog-Comment-Repo',
			owner: 'chen10221122',
			admin: 'chen10221122',
			distractionFreeMode: 'true',
		})
		gitalk.render('gitalk-container');		
	})();
</script>

		
		
	

</div>
				</div>
				<div class="investment-content-list">
					<div class="layout-share">
	
	

		
			
			<!-- socialShare share -->
			<div class="social-share"></div>

<!--  css & js -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
			
		
		
	
</div>


				</div>
			</div>	
		</div>
	</div>
</div>

<!-- show math formula -->



	 
	
<script src="../../../../../plugin/clipboard/clipboard.js"></script>

	<script>
		// Copy code !
	    function preprocessing() {
	        $("#article-content .highlight").each(function() {
	            $(this).wrap('<div id="post-code"></div>');
	        })

	        $("#article-content #post-code").each(function() {
	            $(this).prepend('<nav class="copy-nav"><span><i class="code-language"></i></span></nav>');
	        })

	        $("#article-content .copy-nav").each(function() {
	            let languageClass = $(this).next().attr('class'),
	                language = ((languageClass.length > 9) && (languageClass != null)) ? languageClass.substr(10) : "none"; //why 9? Need to check language?

	            $(this).find('.code-language').text(language);
	            $(this).append('<span class="copy-btn icon-paste"></span>');
	        });
	    }

		function copy() {
		    $('#article-content #post-code').each(function(i) {
		        let codeCopyId = 'codeCopy-' + i;

		        let codeNode = $(this).find('.code'),
		            copyButton = $(this).find('.copy-btn');

		        codeNode.attr('id', codeCopyId);
		        copyButton.attr('data-clipboard-target-id', codeCopyId);
		    })
   
			let clipboard = new ClipboardJS('.copy-btn', {
					target: function(trigger) {
						return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
					}
		      	});

			//pure js
			function showTooltip(elem, msg) {		   
				elem.setAttribute('aria-label', msg);
				elem.setAttribute('class', 'copy-btn icon-clipboard1');
				setTimeout(function() {
					elem.setAttribute('class', 'copy-btn icon-paste');
				}, 2000);
			}

			clipboard.on('success', function(e) {
			    e.clearSelection();
			    console.info('Action:', e.action);		   
			    console.info('Trigger:', e.trigger);
			    showTooltip(e.trigger, 'Copied!');   
			});
			
			clipboard.on('error', function(e) {
			    console.error('Action:', e.action);
			    console.error('Trigger:', e.trigger);
			});
		}
		
		(function copyCode(){
			if ($('.layout-post').length) {
			    preprocessing();
			    copy();
			} 
		})();
	</script>






<link rel="stylesheet" href="../../../../../plugin/fancybox/jquery.fancybox.css">


<script src="../../../../../plugin/fancybox/jquery.fancybox.js"></script>


<script type="text/javascript">
	(function gallerySet(){
		let titleID = $('.article-title a'),
			imageID = $('.article-content img'),
			videoID = $('.article-content video');
		
		let postTitle = titleID.text() ? titleID.text() : "No post title!";
		
		imageID.each(function() {
			let imgPath = $(this).attr('src'),
				imgTitle = $(this).attr('alt') ? $(this).attr('alt') : "No image description!";
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox="gallery" data-caption="《 ' + postTitle + ' 》' + imgTitle + '"href="' + imgPath + '"> </a>');
		});
		
		videoID.each(function() {
			let videoPath = $(this).attr('src');
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox href=" ' + videoPath + ' "> </a>');
		});
		
		//TODO：支持html5 video

		if($('#layout-post').length) {
			$('[data-fancybox="gallery"]').fancybox({
				loop: true,
				buttons: [
					"zoom",
					"share",
					"slideShow",
					"fullScreen",
					//"download",
					"thumbs",
					"close"
				],
				protect: true
			});
		}
	})();
</script>
		</main>

		<!--footer-->
		<footer>
	<div id="navigation-show">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="../../../../../index.html" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="../../../../../archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="../../../../../tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="../../../../../about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="../../../../../gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
	</div>

	<div class="copyright">
		<p>
			 
				&copy;2018 - 2021, content by chenlilin. All Rights Reserved.
			
			
				<!-- <a href="../../../../../http:/hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="../../../../../https:/github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay. -->
			
		</p>
		<p>
			

	<!-- busuanzi -->
	<!-- busuanzi -->



			<a href="javascript:zh_tran('s');" class="zh_click" id="zh_click_s">简体</a> 
			<a href="javascript:zh_tran('t');" class="zh_click" id="zh_click_t">繁體</a>				
		</p>
	</div>		
</footer>
		
	<!-- Local or hitokoto! -->

	
<script src="../../../../../plugin/motto/motto.js"></script>

	
	<script type="text/javascript">
		(function motto(){
			let mottoText = getMingYanContent().split('</br> - </br>'),
			
			mottoTextContent = mottoText[0]?mottoText[0]:'请刷新...',
			
			mottoTextFrom = mottoText[1]?mottoText[1]:'one/一个';
			
			mottoTextContent = mottoTextContent.trim().substring(0, 100);
		
			$("#motto-content").html( mottoTextContent);
			$("#motto-author").html( mottoTextFrom  );
		})();	
	</script>	



<!-- love effect -->

	
<script src="../../../../../plugin/love/love.js"></script>



<!-- back to top -->

	<div id="totop">
	<span class="icon-circle-up"></span>
</div>



<!-- site analysis -->


	<!-- site-analysis -->
	
	
	
	
	
 

<!-- leancloud -->


	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

  

	<!--
	时间：2018-10-3
	描述：
		插件名称：hexo-generator-search-zip
		插件来源: https://github.com/SuperKieran/hexo-generator-search-zip
		代码参考：https://github.com/SuperKieran/TKL/blob/master/layout/_partial/search.ejs(Include: js & css)	
-->
<div class="popup search-popup local-search-popup scrollbar" >
	<div class="local-search-container">
		<span class="popup-btn-close">
      		ESC
   		</span>
		<div class="local-search-header">
			<div class="input-prompt">				
			</div>
			<input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
		</div>
		<div class="local-search-body">
			<div id="local-search-output"></div>
		</div>
		<div class="local-search-footer">
			<div class="topN-post">				
				
								
			</div>
		</div>
	</div>
</div>


<script src="../../../../../plugin/search/ziploader.js"></script>
<script src="../../../../../js/search.js"></script>


<script type="text/javascript">
	var search_path = 'search.json',
		zip_Path = '/search.zip',
		version_Path = '/searchVersion.txt',
		input_Trigger = 'auto',
		top_N = '2';

	themeLocalSearch({
		search_path, 
		zip_Path, 
		version_Path, 
		input_Trigger, 
		top_N
	});
</script>



<script src="../../../../../plugin/chinese/chinese.js"></script>
<script src="../../../../../plugin/imagelazyloader/yall.min.js"></script>
<script src="../../../../../plugin/imageloaded/imagesloaded.pkgd.min.js"></script>
<script src="../../../../../plugin/nicescroll/jquery.nicescroll.js"></script>
<script src="../../../../../plugin/resizediv/resizediv.js"></script>
<script src="../../../../../js/main.js"></script>

	</body>	
</html>