
<!DOCTYPE html>
<html class="html-loading">
		

<head>
	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <title>
    
      webpack-babel-2 构建速度优化、产出代码优化、babel | 陈立林的个人网站
    
  </title>
  <meta name="author" content="来者可追">
  <meta name="keywords" content="" />
  <meta name="description" content="" />
	<!-- favicon -->
  <link rel="shortcut icon" href="../../../../../img/favicon.ico">

  <!-- css -->
  
<link rel="stylesheet" href="../../../../../css/Annie.css">

  
  <!-- jquery -->
	
<script src="../../../../../plugin/jquery/jquery.min.js"></script>


<script>
    const CONFIG_BGIMAGE = {
      mode: 'normal',
      normalSrc: '../../../../../https:/source.unsplash.com/collection/954550/1920x1080',
      randomYouMax: 110,
      randomYouSrc: '../../../../../https:/sariay.github.io/Random-img/',
	  randomOtherSrc: '../../../../../https:/api.berryapi.net/?service=App.Bing.Images&day=-0',
	  preloaderEnable: false
    }
	
    const CONFIG_LEACLOUD_COUNT = {
      enable: false,
	  appId: 'AU8...',
	  appKey: '4cU...',
	  serverURLs: 'http' || ' '
    }
  </script>
<meta name="generator" content="Hexo 4.2.1"></head>
	<body>
		<!-- Preloader -->


<!-- header -->
<header class="fixbackground bg-pan-br">
	<div class="mask">
		<!-- motto -->
		<div class="h-body">	
			
				<div class="motto text-shadow-pop-left">
					<p class="content" id="motto-content">获取中...</p>
					<p>-<p>
					<p class="author" id="motto-author">Just a minute...</p>
				</div>
			
		</div>
		
		<!-- others: such as time... -->			
		<div class="h-footer">
			<a href="javascript:;" id="read-more" class="scroll-down">
				<span class="icon-anchor1 animation-scroll-down"></span>
			</a>
		</div>
	</div>
</header>

<div id="navigation-hide">
	<!-- Progress bar -->
	<div id="progress-bar"></div>

	<!-- Progress percent -->
	<div id="progress-percentage"><span>0.0%</span></div>

	<div class="toc-switch"><span class="switch-button">目录</span></div>

	<!-- Page title -->
	<p>
		
			「webpack-babel-2 构建速度优化、产出代码优化、babel」
		
	</p>

	
	

	<!-- Nav trigger for navigation-H-->
	<a class="nav-trigger"><span></span></a>
</div>

<!-- Navigation in div(id="navigation-H") -->
<nav class="nav-container" id="cd-nav">
	<div class="nav-header">
		<span class="logo"> 
			<img src="../../../../../img/logo.png">
		</span>
		<a href="javascript:;" class="nav-close"></a>
	</div>
	
	<div class="nav-body">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="../../../../../index.html" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="../../../../../archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="../../../../../tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="../../../../../about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="../../../../../gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
	</div>
	
	<div class="nav-footer">
		<ul id="global-social">
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-one"><span class="path1"></span><span class="path2"></span></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-zhihu"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-github"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-sina-weibo "></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-pinterest2"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-instagram"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../http:/github.com/" target="_blank">
				<span class="icon-twitter"></span>
			</a>
		</li>
	
		<li>
			<a href="../../../../../atom.xml" target="_blank">
				<span class="icon-rss"></span>
			</a>
		</li>
			
</ul>

	</div>
</nav>
			
		<!--main-->
		<main>
			<!--
	时间：2018-11-17
	描述：
		插件名称：katelog.min.js
		插件作者：KELEN
		插件来源: https://github.com/KELEN/katelog
-->

	
		<div class="layout-toc">
			<div id="layout-toc">
				<div class="k-catelog-list" id="catelog-list" data-title="文章目录"></div>
			</div>
		</div>

		
<script src="../../../../../plugin/toc/katelog.min.js"></script>


		
	 

<div class="layout-post">
	<div id="layout-post">
		<div class="article-title">
			
	<a href="" itemprop="url">
		webpack-babel-2 构建速度优化、产出代码优化、babel
	</a>

		</div>

		<div class="article-meta">
			<span>
				<i class="icon-calendar1"></i>
				
				




	更新于

	<a href="" itemprop="url">
		<time datetime="2020-12-28T07:19:22.000Z" itemprop="dateUpdated">
	  		2021-04-23
	  </time>
	</a> 



			</span>
			<span>
				
	<i class="icon-price-tags"></i>
	
		<a href="../../../../../tags/webpack/" class=" ">
			webpack
		</a>
	
		
			</span>
			
			



		</div>

		<div class="article-content" id="article-content" >
			<p>构建速度优化、产出代码优化、babel</p>
<a id="more"></a>
<h2 id="10-9-webpack优化构建速度-知识点串讲（性能优化）"><a href="#10-9-webpack优化构建速度-知识点串讲（性能优化）" class="headerlink" title="10-9 webpack优化构建速度-知识点串讲（性能优化）"></a>10-9 webpack优化构建速度-知识点串讲（性能优化）</h2><ul>
<li>热议话题</li>
<li>优化打包构建速度 - 优化开发体验和效率</li>
<li>优化产出代码 - 优化产品性能 </li>
</ul>
<p>一般会让你聊一聊性能优化，可以从上面两个方面来说。</p>
<p><strong>webpack 性能优化 - 构建速度</strong></p>
<ul>
<li>优化 babel-loader   <ul>
<li>babel编译ES6到ES5，这个过程还是消耗比较多的，</li>
</ul>
</li>
<li>IgnorePlugin<ul>
<li>避免哪些插件</li>
</ul>
</li>
<li>noPase<ul>
<li>不去管哪些</li>
</ul>
</li>
<li>happyPack<ul>
<li>多进程打包工具，开启多进程，打包更快</li>
</ul>
</li>
<li>ParallelUglifyPlugin<ul>
<li>开启多进程进行代码压缩</li>
</ul>
</li>
<li>自动刷新<ul>
<li>保存之后，浏览器自动刷新</li>
</ul>
</li>
<li>热更新<ul>
<li>体验更好，自动刷新的升级版</li>
</ul>
</li>
<li>DllPlugin<ul>
<li>针对比较大的第三方插件，没有必要每次都打包，可以事先打包好，作为一个dll，然后打包时引用他</li>
</ul>
</li>
</ul>
<hr>
<p><strong>优化 babel-loader</strong> (性能优化相关代码在<code>build-optimization</code>文件夹)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    loader: [<span class="string">'babel-loader?cacheDirectory'</span>], <span class="comment">// 开启缓存</span></span><br><span class="line">    include: path.resolve(__dirname,<span class="string">'src'</span>), <span class="comment">// 明确范围</span></span><br><span class="line">    <span class="comment">// 排出范围：include 和 exclude 两者选一个即可</span></span><br><span class="line">    <span class="comment">// exclude: path.resolve(__dirname,'node_modules'), </span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ol>
<li>加缓存，加<code>cacheDirectory</code>这个参数，这样没改的地方，第二次编译的时候，就会启用缓存</li>
<li>通过<code>include</code> 和 <code>exclude</code> 来确定范围</li>
</ol>
<h2 id="10-11-happyPack是什么"><a href="#10-11-happyPack是什么" class="headerlink" title="10-11 happyPack是什么"></a>10-11 happyPack是什么</h2><p><strong>happyPack 多进程打包</strong></p>
<p>这个工具在社区中出现的频率也比较多，属于热门词汇。</p>
<ul>
<li>JS单线程，开启多进程打包</li>
<li>这样可以提高构建速度（特别是多核CPU）</li>
</ul>
<p>webpack.prod.js代码演示（也可以在common里面）：首先我们需要先安装HappyPack，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> HappyPack = <span class="built_in">require</span>(<span class="string">'happypack'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        <span class="comment">// js</span></span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">            <span class="comment">// 把对 .js 文件的处理转交给 id 为 babel 的 HappyPack 实例</span></span><br><span class="line">            use: [<span class="string">'happypack/loader?id=babel'</span>],</span><br><span class="line">            include: srcPath,</span><br><span class="line">            <span class="comment">// exclude: /node_modules/</span></span><br><span class="line">        &#125;,</span><br><span class="line">        ......</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个写法是固定的，id=babel，然后plugins里面会new HappyPack，id=babel，这两个地方id要对应</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="comment">// happyPack 开启多进程打包</span></span><br><span class="line">    <span class="keyword">new</span> HappyPack(&#123;</span><br><span class="line">        <span class="comment">// 用唯一的标识符 id 来代表当前的 HappyPack 是用来处理一类特定的文件</span></span><br><span class="line">        id: <span class="string">'babel'</span>,</span><br><span class="line">        <span class="comment">// 如何处理 .js 文件，用法和 Loader 配置中一样</span></span><br><span class="line">        loaders: [<span class="string">'babel-loader?cacheDirectory'</span>]</span><br><span class="line">    &#125;),</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>ParallelUglifyPlugin 多进程压缩 JS</strong></p>
<ul>
<li>wabpack 内置 Uglify工具压缩JS</li>
<li>JS单线程，开启多进程压缩更快</li>
<li>和happyPack同理</li>
</ul>
<p>代码演示：安装插件并配置（ParallelUglifyPlugin只放在prod.js里，因为开发环境没必要压缩）：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ParallelUglifyPlugin = <span class="built_in">require</span>(<span class="string">'webpack-parallel-uglify-plugin'</span>)</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 ParallelUglifyPlugin 并行压缩输出的 JS 代码</span></span><br><span class="line">    <span class="keyword">new</span> ParallelUglifyPlugin(&#123;</span><br><span class="line">        <span class="comment">// 传递给 UglifyJS 的参数</span></span><br><span class="line">        <span class="comment">// （还是使用 UglifyJS 压缩，只不过帮助开启了多进程）</span></span><br><span class="line">        uglifyJS: &#123;</span><br><span class="line">            output: &#123;</span><br><span class="line">                beautify: <span class="literal">false</span>, <span class="comment">// 最紧凑的输出</span></span><br><span class="line">                comments: <span class="literal">false</span>, <span class="comment">// 删除所有的注释</span></span><br><span class="line">            &#125;,</span><br><span class="line">            compress: &#123;</span><br><span class="line">                <span class="comment">// 删除所有的 `console` 语句，可以兼容ie浏览器</span></span><br><span class="line">                drop_console: <span class="literal">true</span>,</span><br><span class="line">                <span class="comment">// 内嵌定义了但是只用到一次的变量</span></span><br><span class="line">                collapse_vars: <span class="literal">true</span>,</span><br><span class="line">                <span class="comment">// 提取出出现多次 但是没有定义成变量去引用的静态值</span></span><br><span class="line">                reduce_vars: <span class="literal">true</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<p><code>collapse_vars: true</code>, 和 <code>reduce_vars: true</code>,会优化一些定义的值，比如</p>
<p>优化前：<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">var a</span>=10; <span class="attribute">v</span><span class="attribute">a</span><span class="attribute">r</span> <span class="attribute">b</span>=10; <span class="attribute">v</span><span class="attribute">a</span><span class="attribute">r</span> <span class="attribute">c</span>= a+b;</span><br></pre></td></tr></table></figure></p>
<p>优化后：<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">var a</span>=10; <span class="attribute">v</span><span class="attribute">a</span><span class="attribute">r</span> <span class="attribute">b</span>=10; <span class="attribute">v</span><span class="attribute">a</span><span class="attribute">r</span> <span class="attribute">c</span>= 30;</span><br></pre></td></tr></table></figure></p>
<p><strong>关于开启多进程：</strong> （再多说一些扩展、背景等）</p>
<ul>
<li>如果项目较大，打包较慢，开启多进程能提高速度</li>
<li>如果项目较小，打包很快，开启多进程会降低速度（进程开销）<ul>
<li>进程要启动、进程要销毁、进程之间要通讯，这个开销也比较大</li>
</ul>
</li>
<li>按需使用</li>
</ul>
<p>所以项目小的时候，开启多进程并不明显，或者根本没用。但是项目大的时候有用。</p>
<h2 id="10-12-webpack如何配置热更新"><a href="#10-12-webpack如何配置热更新" class="headerlink" title="10-12 webpack如何配置热更新"></a>10-12 webpack如何配置热更新</h2><p><strong>自动刷新</strong></p>
<p>这个很好理解，改完之后浏览器自动刷新</p>
<p><img src="/images/20204/react-theory-25.png" alt="配置自动刷新"></p>
<p>但是大多时候我们用不上这个配置。开发环境下一般用devServer，开启devServer，自动刷新会默认开启。知道这个东西就好。</p>
<p><strong>热更新</strong></p>
<ul>
<li>自动刷新：整个网页全部刷新，速度较慢</li>
<li>自动刷新：状态会丢失（如之前输入的内容，或深层级的路由）</li>
<li>热更新：新代码生效，网页不杀新，状态不丢失</li>
<li>热更新：按需使用，</li>
</ul>
<p>和自动刷新不同，自动刷新是整个页面刷新 ，会清空之前的内容，热更新</p>
<p>代码演示：</p>
<ol>
<li>我们可以直接引用webpack自带的插件，HotModuleReplacementPlugin，</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HotModuleReplacementPlugin = <span class="built_in">require</span>(<span class="string">'webpack/lib/HotModuleReplacementPlugin'</span>);</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>entry里面需要改变，网址对应本地的项目</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line">    <span class="comment">// index: path.join(srcPath, 'index.js'),</span></span><br><span class="line">    index: [</span><br><span class="line">        <span class="string">'webpack-dev-server/client?http://localhost:8080/'</span>,</span><br><span class="line">        <span class="string">'webpack/hot/dev-server'</span>,</span><br><span class="line">        path.join(srcPath, <span class="string">'index.js'</span>)</span><br><span class="line">    ],</span><br><span class="line">    other: path.join(srcPath, <span class="string">'other.js'</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>使用插件</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> HotModuleReplacementPlugin()</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>devServer里面，hot:true</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ol start="5">
<li><p>其他用法，网上查找</p>
</li>
<li><p>修改js的时候，并未热更新（或直接刷新了）：我们需要增加配置，允许哪些模块进行热更新 ，还有回调函数</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 增加，开启热更新之后的代码逻辑</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">    <span class="built_in">module</span>.hot.accept([<span class="string">'./math'</span>], () =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> sumRes = sum(<span class="number">10</span>, <span class="number">30</span>)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'sumRes in hot'</span>, sumRes)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里回调函数，是修改了math里内容的回调。热更新是有成本的，我们需要自己注册，那些模块需要热更新，</p>
<h2 id="10-13-何时使用DllPlugin"><a href="#10-13-何时使用DllPlugin" class="headerlink" title="10-13 何时使用DllPlugin"></a>10-13 何时使用DllPlugin</h2><p><strong>DllPlugin 动态链接库插件</strong>。windows系统很常见，很多文件都是.dll。只是一个插件。思路就是先打包好，然后再使用。</p>
<ul>
<li>前端框架如 vue React ，体积大，构建慢</li>
<li>较稳定，不常升级版本</li>
<li>同一个版本只构建一次即可，不用每次都重新构建</li>
<li>按需使用</li>
</ul>
<p>包括两个插件，先打包，再使用</p>
<ul>
<li>webpack 已内置 Dllplugin支持</li>
<li>DllPlugin - 打包出dll文件<ul>
<li>通过配置 webpack.dll.js，dist里面产出 打包的内容和索引</li>
</ul>
</li>
<li>DllReferencePlugin - 使用 dll 文件<ul>
<li><ol>
<li>引入产出的js  2. plugins里面配置地址  </li>
</ol>
</li>
<li>这个配置，对源代码不影响</li>
</ul>
</li>
</ul>
<p>代码演示：webpack-dll-demo,使用React演示DllPlugin的使用</p>
<p> index.js:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import React from 'react'</span><br><span class="line">import ReactDOM from 'react-dom'</span><br><span class="line">import App from './App'</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span>,</span><br><span class="line">    document.getElementById('root')</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>app.js</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import React from 'react'</span><br><span class="line"></span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        super(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        return <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is App Component.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App</span><br></pre></td></tr></table></figure>
<ol>
<li>在build文件夹下，需要配置一个webpack.dll.js。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> DllPlugin = <span class="built_in">require</span>(<span class="string">'webpack/lib/DllPlugin'</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; srcPath, distPath &#125; = <span class="built_in">require</span>(<span class="string">'./paths'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  <span class="comment">// JS 执行入口文件</span></span><br><span class="line">  entry: &#123;</span><br><span class="line">    <span class="comment">// 把 React 相关模块的放到一个单独的动态链接库</span></span><br><span class="line">    react: [<span class="string">'react'</span>, <span class="string">'react-dom'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// 输出的动态链接库的文件名称，[name] 代表当前动态链接库的名称，</span></span><br><span class="line">    <span class="comment">// 也就是 entry 中配置的 react 和 polyfill</span></span><br><span class="line">    filename: <span class="string">'[name].dll.js'</span>,</span><br><span class="line">    <span class="comment">// 输出的文件都放到 dist 目录下</span></span><br><span class="line">    path: distPath,</span><br><span class="line">    <span class="comment">// 存放动态链接库的全局变量名称，例如对应 react 来说就是 _dll_react</span></span><br><span class="line">    <span class="comment">// 之所以在前面加上 _dll_ 是为了防止全局变量冲突</span></span><br><span class="line">    library: <span class="string">'_dll_[name]'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// 接入 DllPlugin</span></span><br><span class="line">    <span class="keyword">new</span> DllPlugin(&#123;</span><br><span class="line">      <span class="comment">// 动态链接库的全局变量名称，需要和 output.library 中保持一致</span></span><br><span class="line">      <span class="comment">// 该字段的值也就是输出的 manifest.json 文件 中 name 字段的值</span></span><br><span class="line">      <span class="comment">// 例如 react.manifest.json 中就有 "name": "_dll_react"</span></span><br><span class="line">      name: <span class="string">'_dll_[name]'</span>,</span><br><span class="line">      <span class="comment">// 描述动态链接库的 manifest.json 文件输出时的文件名称</span></span><br><span class="line">      path: path.join(distPath, <span class="string">'[name].manifest.json'</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>在package.json里面，配置dll，用这个来打包，运行<code>npm run dll</code></li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">  <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --config build/webpack.dev.js"</span>,</span><br><span class="line">  <span class="string">"dll"</span>: <span class="string">"webpack --config build/webpack.dll.js"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><p>dist目录下输出了两个文件，<code>react.dll</code> 和 <code>react.manifest.json</code></p>
<ul>
<li>react.dll:加载了所有关于入口（enrty里配置）的react和react-dom的文件，</li>
<li>react.manifest.json ： 他是一个索引。通过这个，找到对应的。</li>
</ul>
</li>
<li><p>使用：在app.js和index.js里面之前的import写法不用变，index.html里面需要手动引用:</p>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./react.dll.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="5">
<li>引用之后，在webpack.dev.js里面的plugins里面使用：使用分第一、第二、第三</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; smart &#125; = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> webpackCommonConf = <span class="built_in">require</span>(<span class="string">'./webpack.common.js'</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; srcPath, distPath &#125; = <span class="built_in">require</span>(<span class="string">'./paths'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第一，引入 DllReferencePlugin</span></span><br><span class="line"><span class="keyword">const</span> DllReferencePlugin = <span class="built_in">require</span>(<span class="string">'webpack/lib/DllReferencePlugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = smart(webpackCommonConf, &#123;</span><br><span class="line">    mode: <span class="string">'development'</span>,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                loader: [<span class="string">'babel-loader'</span>],</span><br><span class="line">                include: srcPath,</span><br><span class="line">                exclude: <span class="regexp">/node_modules/</span> <span class="comment">// 第二，不要再转换 node_modules 的代码</span></span><br><span class="line">            &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">            <span class="comment">// window.ENV = 'production'</span></span><br><span class="line">            ENV: <span class="built_in">JSON</span>.stringify(<span class="string">'development'</span>)</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 第三，告诉 Webpack 使用了哪些动态链接库</span></span><br><span class="line">        <span class="keyword">new</span> DllReferencePlugin(&#123;</span><br><span class="line">            <span class="comment">// 描述 react 动态链接库的文件内容</span></span><br><span class="line">            manifest: <span class="built_in">require</span>(path.join(distPath, <span class="string">'react.manifest.json'</span>)),</span><br><span class="line">        &#125;),</span><br><span class="line">    ],</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        port: <span class="number">8080</span>,</span><br><span class="line">        progress: <span class="literal">true</span>,  <span class="comment">// 显示打包的进度条</span></span><br><span class="line">        contentBase: distPath,  <span class="comment">// 根目录</span></span><br><span class="line">        open: <span class="literal">true</span>,  <span class="comment">// 自动打开浏览器</span></span><br><span class="line">        compress: <span class="literal">true</span>,  <span class="comment">// 启动 gzip 压缩</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置代理</span></span><br><span class="line">        proxy: &#123;</span><br><span class="line">            <span class="comment">// 将本地 /api/xxx 代理到 localhost:3000/api/xxx</span></span><br><span class="line">            <span class="string">'/api'</span>: <span class="string">'http://localhost:3000'</span>,</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将本地 /api2/xxx 代理到 localhost:3000/xxx</span></span><br><span class="line">            <span class="string">'/api2'</span>: &#123;</span><br><span class="line">                target: <span class="string">'http://localhost:3000'</span>,</span><br><span class="line">                pathRewrite: &#123;</span><br><span class="line">                    <span class="string">'/api2'</span>: <span class="string">''</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>此时npm run dev，就不会再对 React进行打包</p>
<h2 id="10-14-webpack优化构建速度-考点总结和复习"><a href="#10-14-webpack优化构建速度-考点总结和复习" class="headerlink" title="10-14 webpack优化构建速度-考点总结和复习"></a>10-14 webpack优化构建速度-考点总结和复习</h2><p><strong>webpack优化构建速度（可用于生产环境）</strong></p>
<ul>
<li>优化 babel-loader   <ul>
<li>缓存 （可只用于开发环境，生产环境打包不多）</li>
<li>明确范围（或排除哪些范围）</li>
</ul>
</li>
<li>IgnorePlugin<ul>
<li>避免一些模块的引用</li>
</ul>
</li>
<li>noPase<ul>
<li>引入后避免打包</li>
</ul>
</li>
<li>happyPack<ul>
<li>生产环境可以用</li>
</ul>
</li>
<li>ParallelUglifyPlugin<ul>
<li>生产环境一般用</li>
</ul>
</li>
</ul>
<p><strong>webpack优化构建速度（不可用于生产环境）</strong></p>
<ul>
<li>自动刷新</li>
<li>热更新</li>
<li>DllPlugin （只为满足开发环境下，打包速度优化）</li>
</ul>
<h2 id="10-15-webpack优化产出代码-考点串讲"><a href="#10-15-webpack优化产出代码-考点串讲" class="headerlink" title="10-15 webpack优化产出代码-考点串讲"></a>10-15 webpack优化产出代码-考点串讲</h2><p>和线上性能有关，所以更重要。好处：</p>
<ul>
<li>体积更小、加载更快</li>
<li>合理分包，不重复加载<ul>
<li>多入口可能有重复的逻辑，可以把它们分出来</li>
</ul>
</li>
<li>执行速度更快，内存使用更少</li>
</ul>
<p>方法：</p>
<ol>
<li>小图片base64编码</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 图片 - 考虑 base64 编码的情况</span></span><br><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.(png|jpg|jpeg|gif)$/</span>,</span><br><span class="line">    use: &#123;</span><br><span class="line">        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">            <span class="comment">// 小于 5kb 的图片用 base64 格式产出</span></span><br><span class="line">            <span class="comment">// 否则，依然延用 file-loader 的形式，产出 url 格式</span></span><br><span class="line">            limit: <span class="number">5</span> * <span class="number">1024</span>,</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 打包到 img 目录下</span></span><br><span class="line">            outputPath: <span class="string">'/img1/'</span>,</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 设置图片的 cdn 地址（也可以统一在外面的 output 中设置，那将作用于所有静态资源）</span></span><br><span class="line">            <span class="comment">// publicPath: 'http://cdn.abc.com'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>bundle 加 hash</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    filename: <span class="string">'bundle.[contentHash:8].js'</span>,  <span class="comment">// 打包代码时，加上 hash 戳</span></span><br><span class="line">    <span class="comment">// filename: '[name].[contentHash:8].js', // name 即多入口时 entry 的 key</span></span><br><span class="line">    path: distPath,</span><br><span class="line">    <span class="comment">// publicPath: 'http://cdn.abc.com'  // 修改所有静态文件 url 的前缀（如 cdn 域名），这里暂时用不到</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><p>懒加载  通过懒加载语法，异步加载大文件。和 Vue组件异步、路由异步加载都是一个道理</p>
</li>
<li><p>提取公共代码，没必要在多入口中全都打包</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 分割代码块</span></span><br><span class="line">splitChunks: &#123;</span><br><span class="line">    chunks: <span class="string">'all'</span>,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * initial 入口chunk，对于异步导入的文件不处理</span></span><br><span class="line"><span class="comment">        async 异步chunk，只对异步导入的文件处理</span></span><br><span class="line"><span class="comment">        all 全部chunk</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 缓存分组</span></span><br><span class="line">    cacheGroups: &#123;</span><br><span class="line">        <span class="comment">// 第三方模块</span></span><br><span class="line">        vendor: &#123;</span><br><span class="line">            name: <span class="string">'vendor'</span>, <span class="comment">// chunk 名称</span></span><br><span class="line">            priority: <span class="number">1</span>, <span class="comment">// 权限更高，优先抽离，重要！！！</span></span><br><span class="line">            test: <span class="regexp">/node_modules/</span>,</span><br><span class="line">            minSize: <span class="number">0</span>,  <span class="comment">// 大小限制</span></span><br><span class="line">            minChunks: <span class="number">1</span>  <span class="comment">// 最少复用过几次</span></span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 公共的模块</span></span><br><span class="line">        common: &#123;</span><br><span class="line">            name: <span class="string">'common'</span>, <span class="comment">// chunk 名称</span></span><br><span class="line">            priority: <span class="number">0</span>, <span class="comment">// 优先级</span></span><br><span class="line">            minSize: <span class="number">0</span>,  <span class="comment">// 公共模块的大小限制</span></span><br><span class="line">            minChunks: <span class="number">2</span>  <span class="comment">// 公共模块最少复用过几次</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li><p>IngorePlugin，使打包的代码更少，忽略掉一些</p>
</li>
<li><p>使用CDN加速：引用cdn地址，还需要cdn服务，并把静态文件上传到cdn服务器</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    <span class="comment">// filename: 'bundle.[contentHash:8].js',  // 打包代码时，加上 hash 戳</span></span><br><span class="line">    filename: <span class="string">'[name].[contentHash:8].js'</span>, <span class="comment">// name 即多入口时 entry 的 key</span></span><br><span class="line">    <span class="comment">// path: distPath,</span></span><br><span class="line">    publicPath: <span class="string">'http://cdn.abc.com'</span>  <span class="comment">// 修改所有静态文件 url 的前缀（如 cdn 域名）</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>使用production</li>
<li>Scope Hosting</li>
</ol>
<h2 id="10-16-什么是Tree-Shaking"><a href="#10-16-什么是Tree-Shaking" class="headerlink" title="10-16 什么是Tree-Shaking"></a>10-16 什么是Tree-Shaking</h2><p><strong>使用production</strong></p>
<p>之前我们说过，要拆分配置，拆分<code>dev</code>和 <code>prod</code>的配置。dev里面<code>mode：&#39;development&#39;</code>。prod里面  <code>mode:&#39;production&#39;</code>，这样就是使用production。</p>
<p>使用production好处：</p>
<ul>
<li>自动开启代码压缩 （webpack4.x后)</li>
<li>Vue React 等会自动删掉调试代码（如开发环境的warning）<ul>
<li>可以执行更快</li>
<li>可以减小vue的体积，加载更快</li>
</ul>
</li>
<li>启用 Tree-Shaking</li>
</ul>
<p>Tree-Shaking代码演示：我们再index.js中引用mathj.js，并使用其中的一个方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; sum &#125; <span class="keyword">from</span> <span class="string">'./math'</span> <span class="comment">// 引入js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sumRes = sum(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'sumRes'</span>, sumRes)</span><br></pre></td></tr></table></figure>
<p>math.js：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> sum = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mult = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a * b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果直接dev运行，mode:是就是development。打包后的代码里面，还是会有mult函数。</p>
<p>在线上环境，我们希望把没有用到的代码删掉，这就是Tree-Shaking。顾名思义：树-摇晃，摇树优化 ，把没有用的东西摇下来。</p>
<p>开启 <code>mode:&#39;production&#39;</code> 后，Tree-Shaking就会开启。</p>
<blockquote>
<p>注意：必须用 ES6 Module （模块化) 才能让 tree-shaking 生效。CommonJS 就不行</p>
</blockquote>
<blockquote>
<p>因为ES6模块化语法是静态的(在导入，导出语句中的路径必须是静态的字符串)。</p>
</blockquote>
<h2 id="10-17-ES6-Module-和-Commonjs-的区别"><a href="#10-17-ES6-Module-和-Commonjs-的区别" class="headerlink" title="10-17 ES6 Module 和 Commonjs 的区别"></a>10-17 ES6 Module 和 Commonjs 的区别</h2><p>前端一般用ES6 Module，nodejs一般用Commonjs，前端也可以通过webpack配置，实现Commonjs。</p>
<ul>
<li>ES6 Module 是静态引入，编译时引入<ul>
<li>必须是无条件的，直接引用过来，在打包的时候能直接识别到，</li>
<li>不能在条件中引用，不能通过代码的变量判断是否引用</li>
</ul>
</li>
<li>Commonjs 是动态引入，执行时引入<ul>
<li>打包时并不知道引用的是什么，执行的时候才能引用过来</li>
</ul>
</li>
<li>只有ES6 Module 才能静态分析，实现 Tree-Shaking<ul>
<li>Tree-Shaking是webpack打包时执行的，打包的时候，代码并没有执行，</li>
<li>也就是说webpack打包，只是一个静态分析，只是一个编译、构建，还没有被运行</li>
<li><strong>故只有静态引入，才能实现Tree-Shaking</strong></li>
</ul>
</li>
</ul>
<p>若动态引入，静态分析的时候无法分析，只有执行 的时候才知道需要那一块。</p>
<p>何为静态、动态？</p>
<p><img src="/images/20204/react-theory-26.jpg" alt="静态、动态引入"></p>
<p>动态引入：require可以放在判断条件里。因为是执行时引入，执行的时候，可以判断。</p>
<p>静态引入：不允许动态引入。因为是编译时引入的，还没有执行。</p>
<h2 id="10-18-什么是Scope-Hosting"><a href="#10-18-什么是Scope-Hosting" class="headerlink" title="10-18 什么是Scope Hosting"></a>10-18 什么是Scope Hosting</h2><p>我们有两个文件：main.js是入口文件，引入了hello.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hello.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'Hello World'</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> str <span class="keyword">from</span> <span class="string">'./hello.js'</span></span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br></pre></td></tr></table></figure>
<p>打包之后是这样的：</p>
<p><img src="/images/20204/react-theory-27.jpg" alt="打包之后是这样的"></p>
<p>开发的时候是分两个文件开发，打包后，变成两个函数。实际开发中生成很多函数，每个函数都有作用域，这样对于js代码执行和内存的消耗… 是很不友好的</p>
<p>那么我们希望打包之后变成这样：两个函数合二为一。</p>
<p><img src="/images/20204/react-theory-28.jpg" alt="那么我们希望打包之后变成这样"></p>
<p>这样作用域的数量就更少，内存占用更少，也不用频繁的跨作用域调用，js就会执行的更快。</p>
<p><strong>总结：</strong></p>
<ul>
<li>代码体积更小</li>
<li>创建函数作用域更少</li>
<li>代码可读性更好</li>
</ul>
<p><strong>如何配置？</strong></p>
<ol>
<li>引用这个插件</li>
<li>开启插件</li>
<li>需要条件：优先引用<code>jsnext:main</code> 指向的文件名</li>
</ol>
<p><img src="/images/20204/react-theory-29.jpg" alt="如何配置 Scope Hosting"></p>
<blockquote>
<p>重点指导原理 和 优化之后的效果</p>
</blockquote>
<hr>
<p><strong>webpack 性能优化 – 产出代码</strong></p>
<ul>
<li>小图片 base64 编码</li>
<li>bundle 加 hash</li>
<li>懒加载</li>
<li>提取公共代码</li>
<li>使用 CDN 加速</li>
<li>使用 production</li>
<li>Scope Hosting</li>
</ul>
<h2 id="10-19-babel基本概念串讲"><a href="#10-19-babel基本概念串讲" class="headerlink" title="10-19 babel基本概念串讲"></a>10-19 babel基本概念串讲</h2><p>解析ES6或更高级的语法到ES5，满足浏览器的兼容性。</p>
<ul>
<li>前端开发环境必备工具</li>
<li>同webpack，需要了解基本的配置和使用</li>
</ul>
<p>要点:</p>
<ul>
<li>环境搭建&amp;基础配置</li>
<li>babel-polyfill<ul>
<li>corejs 和 regenerate的集合</li>
<li>7.4 之后弃用，直接使用corejs 和 regenerate</li>
</ul>
</li>
<li>babel-runtime<ul>
<li>重新定义名称，不会污染全局环境</li>
</ul>
</li>
</ul>
<hr>
<p><strong>babel环境搭建&amp;基础配置</strong></p>
<ul>
<li>环境搭建</li>
<li>.babelrc 配置</li>
<li>presets 和 plugins</li>
</ul>
<p>代码演示：需要引入这些包</p>
<p><img src="/images/20204/react-theory-30.jpg" alt="环境搭建"></p>
<p>.babelrc配置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [</span><br><span class="line">        [</span><br><span class="line">            <span class="string">"@babel/preset-env"</span>,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"useBuiltIns"</span>: <span class="string">"usage"</span>,</span><br><span class="line">                <span class="string">"corejs"</span>: <span class="number">3</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"plugins"</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.js内容:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sum = <span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b</span><br></pre></td></tr></table></figure>
<p>启用babel编辑js，运行。输出后，会把es6编译成es5;</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">npx</span> <span class="keyword">babel </span>src/index.js</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>presets 和 plugins</strong></p>
<p>babel是需要写很多plugins ，才知道如何转换；我们不会写很多plugins，可以写一个预设，包含常用的plugins，这个预设就叫presets，他就是很多plugins的集合。</p>
<p>这个预设里面就包含了很多常用的plugins。 若 presets 满足不了要求，可以再扩展 plugins</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [</span><br><span class="line">        [</span><br><span class="line">            <span class="string">"@babel/preset-env"</span>,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"useBuiltIns"</span>: <span class="string">"usage"</span>,</span><br><span class="line">                <span class="string">"corejs"</span>: <span class="number">3</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ], </span><br><span class="line">    <span class="string">"plugins"</span>: [</span><br><span class="line">      </span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>更多可以参考(官网)[<a href="https://www.babeljs.cn/docs/presets]" target="_blank" rel="noopener">https://www.babeljs.cn/docs/presets]</a>  <a href="https://www.babeljs.cn/docs/presets" target="_blank" rel="noopener">https://www.babeljs.cn/docs/presets</a></p>
<h2 id="10-20-babel-polyfill是什么"><a href="#10-20-babel-polyfill是什么" class="headerlink" title="10-20 babel-polyfill是什么"></a>10-20 babel-polyfill是什么</h2><p>polyfill这个该概念很早就有了，是补丁的意思，比webpack\babel还要早。在之前，有些旧版本的浏览器，不支持某些方法，我们就需要手动打补丁（兼容)。</p>
<p><strong>core-js 和 regenerator:</strong></p>
<p>之前我们是手动找polyfill的，我们需要一个官方的、更全面的polyfill的集合，这个集合就是(core-js)[<a href="https://github.com/zloirock/core-js]。他是一个标准库，继承了所有的新的语法的polyfill。" target="_blank" rel="noopener">https://github.com/zloirock/core-js]。他是一个标准库，继承了所有的新的语法的polyfill。</a></p>
<p>但是有一个地方满足不了： ES6的 generator 函数（后来大部分被 async/await 代替，用的人少）。所以还需要引用regenerator这个库，从而来支持 generator 语法。</p>
<blockquote>
<p>babel-polyfill 就是  core-js 和 regenerator 两者的集合。</p>
</blockquote>
<ul>
<li>Babel 7.4 之后弃用 babel-polyfill</li>
<li>推荐直接使用 core-js 和 regenerator</li>
<li>但不影响我们学习他。</li>
</ul>
<h2 id="10-21-babel-polyfill如何按需引入"><a href="#10-21-babel-polyfill如何按需引入" class="headerlink" title="10-21 babel-polyfill如何按需引入"></a>10-21 babel-polyfill如何按需引入</h2><p>代码演示：我们添加一些代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新的 API</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve(<span class="number">100</span>).then(<span class="function"><span class="params">data</span> =&gt;</span> data);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新的 API</span></span><br><span class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>].includes(<span class="number">20</span>)</span><br></pre></td></tr></table></figure>
<p>对于Promise和 .includes，babel无法解析；因为babel只解析语法 ，像上面这两种，他们的语法本身就是符合ES5规范的；至于数组是否有includes这个方法，这不是babel所关心的；但是这样是不满足我们需求的。</p>
<blockquote>
<p>babel 只关心语法，不关心是否有这个api（polyfill解决）<br>babel 不处理模块化，（webpack处理）</p>
</blockquote>
<p>所以我们需要引入babel-polyfill，来支持新的特性：这样我们都可以兼容了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"></span><br><span class="line"><span class="string">"dependencies"</span>: &#123;</span><br><span class="line"><span class="string">"@babel/polyfill"</span>: <span class="string">"^7.7.0"</span>,</span><br><span class="line"><span class="string">"@babel/runtime"</span>: <span class="string">"^7.7.5"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>babel-polyfill按需引入</strong></p>
<p>babel-polyfill文件较大，只有一部分功能，无需全部引入，可以配置按需引入：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .babelrc</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [</span><br><span class="line">        [</span><br><span class="line">            <span class="string">"@babel/preset-env"</span>,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"useBuiltIns"</span>: <span class="string">"usage"</span>,  <span class="comment">// 按需引入</span></span><br><span class="line">                <span class="string">"corejs"</span>: <span class="number">3</span>     <span class="comment">// 版本号</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ],</span><br><span class="line">    ......</span><br></pre></td></tr></table></figure>
<p>npx 运行一下，此时可以看到，需要哪些才会require哪些</p>
<h2 id="10-22-babel-runtime是什么"><a href="#10-22-babel-runtime是什么" class="headerlink" title="10-22 babel-runtime是什么"></a>10-22 babel-runtime是什么</h2><p><strong>babel-polyfill的问题：</strong></p>
<ul>
<li>会污染全局环境</li>
</ul>
<p>我们之前按需引入的core.js里面的东西，他会以这种方法实现，只有这样才会兼容；但是这样会污染全局环境</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 污染全局环境</span></span><br><span class="line"><span class="built_in">window</span>.Promise = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="built_in">Array</span>.prototype.includes = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果做一个独立的web系统，则无碍</li>
<li>如果做一个第三方lib，则会有问题</li>
</ul>
<p>这就会导致一个问题，比如使用方会因为特殊原因这样用：就会出问题；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用方：</span></span><br><span class="line"><span class="built_in">window</span>.Promise = <span class="string">'abc'</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.includes = <span class="number">100</span></span><br></pre></td></tr></table></figure>
<p>解决方法：我们可以自定义方法名字，防止冲突，类似这种。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">window</span>.Promise1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="built_in">Array</span>.prototype.includes1 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>这时候就需要 babel-runtime</p>
<hr>
<p><strong>演示babel-runtime</strong></p>
<p>1.首先安装这两个插件：以runtime结尾的那两个</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"></span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"@babel/cli"</span>: <span class="string">"^7.7.5"</span>,</span><br><span class="line">    <span class="string">"@babel/core"</span>: <span class="string">"^7.7.5"</span>,</span><br><span class="line">    <span class="string">"@babel/plugin-transform-runtime"</span>: <span class="string">"^7.7.5"</span>,</span><br><span class="line">    <span class="string">"@babel/preset-env"</span>: <span class="string">"^7.7.5"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"@babel/polyfill"</span>: <span class="string">"^7.7.0"</span>,</span><br><span class="line">    <span class="string">"@babel/runtime"</span>: <span class="string">"^7.7.5"</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>在 .babelrc 里面做一个配置，默认配置就好。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"plugins"</span>: [</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"@babel/plugin-transform-runtime"</span>,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"absoluteRuntime"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"corejs"</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="string">"helpers"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"regenerator"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"useESModules"</span>: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>npx 运行，会发现我们的方法重新取名字了:include 变成了 _include</li>
</ol>
<p>这样就是没有任何副作用的。</p>
<h2 id="10-23-webpack考点总结和复习"><a href="#10-23-webpack考点总结和复习" class="headerlink" title="10-23 webpack考点总结和复习"></a>10-23 webpack考点总结和复习</h2><ul>
<li>基本配置<ul>
<li>拆分配置和 merge</li>
<li>启动本地服务、Proxy</li>
<li>处理 ES6 （babel-loader）</li>
<li>处理样式</li>
<li>处理图片 （生产、本地）</li>
<li></li>
</ul>
</li>
<li>高级配置<ul>
<li>多入口</li>
<li>抽离CSS文件（抽离、压缩）</li>
<li>抽离公共代码 抽离第三方库、抽离公共代码</li>
<li>懒加载 </li>
<li>处理JSX</li>
<li>处理Vue</li>
</ul>
</li>
<li>优化打包效率（重要）<ul>
<li>优化构建速度（可用于生产环境）<ul>
<li>优化 babel-loader</li>
<li>IgnorePlugin</li>
<li>noParse</li>
<li>happyPack</li>
<li>ParallelUglifyPlugin</li>
</ul>
</li>
<li>优化构建速度（不可用于生产环境）<ul>
<li>自动刷新</li>
<li>热更新</li>
<li>DllPlugin</li>
</ul>
</li>
</ul>
</li>
<li>优化产出代码（重要）<ul>
<li>小图片 base64 编码</li>
<li>bundle加 hash</li>
<li>懒加载</li>
<li>提取公共代码</li>
<li>使用 CDN 加速</li>
<li>IgnorePlugin</li>
<li>使用 production</li>
<li>Scope Hosting</li>
</ul>
</li>
<li>babel<ul>
<li>环境搭建&amp;基本配置 </li>
<li>babel-polyfill</li>
<li>babel-runtime</li>
</ul>
</li>
<li>构建流程概述</li>
</ul>
<h2 id="10-24-webpack面试真题-前端代码为何要打包和构建"><a href="#10-24-webpack面试真题-前端代码为何要打包和构建" class="headerlink" title="10-24 webpack面试真题-前端代码为何要打包和构建"></a>10-24 webpack面试真题-前端代码为何要打包和构建</h2><p>没有标准答案，可能会比较细节。这了聊一下比较关键的概念，然后结合自己掌握的信息。</p>
<p><strong>代码层面：</strong></p>
<ul>
<li>体积更小（Tree-Shaking、压缩、合并），加载更快</li>
<li>编辑高级语言或语法（TS,ES6+,模块化，scss）</li>
<li>兼容性和错误检查（Polyfill、postcss、eslint）</li>
</ul>
<p><strong>研发流程层面：</strong></p>
<p>我们的前端已经是一个功能完备的阶段，标准已经统一</p>
<ul>
<li>统一、高效的开发环境，方便共同维护</li>
<li>统一的构建流程和产出标准</li>
<li>集成公司构建规范（提测、上线等）</li>
</ul>
<hr>
<p><strong>module chunk bundle 的区别：</strong></p>
<ul>
<li>module - 各个源码文件，webpack 中一切皆模块</li>
<li>chunk - 多模块合并成的，如 entry import() splitChunk</li>
<li>bundle - 最终的输出文件</li>
</ul>
<p><strong>loader 和 plugin 的区别：</strong></p>
<ul>
<li>loader 模块转换器，如 less -&gt; css</li>
<li>plugin 扩展插件，如 HtmlWebpackPlugin</li>
</ul>
<p><strong>常见 loader 和 plugin 有哪些</strong></p>
<ul>
<li><a href="https://www.webpackjs.com/loaders/" target="_blank" rel="noopener">https://www.webpackjs.com/loaders/</a></li>
<li><a href="https://www.webpackjs.com/plugins/" target="_blank" rel="noopener">https://www.webpackjs.com/plugins/</a></li>
<li>结合上面讲过的</li>
</ul>
<p>这两个链接里面，有我们常用的loaders和plugins，有些上面已经讲过，</p>
<h2 id="10-25-webpack面试真题-为何Proxy不能被Polyfill"><a href="#10-25-webpack面试真题-为何Proxy不能被Polyfill" class="headerlink" title="10-25 webpack面试真题-为何Proxy不能被Polyfill"></a>10-25 webpack面试真题-为何Proxy不能被Polyfill</h2><p><strong>babel 和 webpack 的区别</strong></p>
<ul>
<li>babel - JS新语法编译工具，不关心模块化</li>
<li>webpack - 打包构建工具，是多个 loader plugin 的集合，不关心语法<ul>
<li>webpack的能力取决于配置了哪些 loader 和 plugin </li>
</ul>
</li>
</ul>
<p><strong>如何产出一个 lib</strong></p>
<ul>
<li>参考 webpack.dll.js</li>
<li>output.library</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">output:&#123;</span><br><span class="line">    <span class="comment">// lib 文件名</span></span><br><span class="line">    filename:<span class="string">'lodash.js'</span>,</span><br><span class="line">    <span class="comment">// 输出 lib 到 dist 目录下</span></span><br><span class="line">    path:distPath,</span><br><span class="line">    <span class="comment">// lib 的全局变量名</span></span><br><span class="line">    library:<span class="string">'lodash'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样配置就能产出一个第三方的类、工具</p>
<p><strong>babel-polyfill 和 babel-runtime 的区别</strong></p>
<ul>
<li>babel-polyfill 会污染全局</li>
<li>babel-runtime 不会污染全局</li>
<li>产出第三方 lib 要用 babel-runtime</li>
</ul>
<p><strong>webpack 如何实现懒加载</strong></p>
<ul>
<li>import()</li>
<li>结合 Vue React 异步组件</li>
<li>集合 Vue-router React-router 异步加载路由</li>
</ul>
<p><strong>为何Proxy不能被Polyfill</strong></p>
<ul>
<li>如 Class 可以用 function 模拟</li>
<li>如 Promise 可以用 callback 来模拟</li>
<li>但是 Proxy 的功能无法用 Object.defineProperty模拟</li>
</ul>
<h2 id="10-26-webpack面试真题-常见性能优化方法"><a href="#10-26-webpack面试真题-常见性能优化方法" class="headerlink" title="10-26 webpack面试真题-常见性能优化方法"></a>10-26 webpack面试真题-常见性能优化方法</h2><ul>
<li>优化打包效率<ul>
<li>优化构建速度（可用于生产环境）<ul>
<li>优化 babel-loader</li>
<li>IgnorePlugin</li>
<li>noParse</li>
<li>happyPack</li>
<li>ParallelUglifyPlugin</li>
</ul>
</li>
<li>优化构建速度（不可用于生产环境）<ul>
<li>自动刷新</li>
<li>热更新 （使用场景）</li>
<li>DllPlugin （使用场景）</li>
</ul>
</li>
</ul>
</li>
<li>优化产出代码 （原理、产出效果、副作用）<ul>
<li>小图片 base64 编码</li>
<li>bundle加 hash</li>
<li>懒加载</li>
<li>提取公共代码</li>
<li>使用 CDN 加速</li>
<li>IgnorePlugin</li>
<li>使用 production</li>
<li>Scope Hosting</li>
</ul>
</li>
</ul>
	
		</div>
		
		<div id="current-post-cover" data-scr="../../../../../img/cart_cover.jpg"></div>

		<!-- relate post, comment...-->
		<div class="investment-container">
			<div class="investment-header">
				<div class="investment-title-1">
					<div class="on">相关文章</div>
					<div>评论</div>
					<div>分享</div>
				</div>
				<div class="investment-title-2">	            
					
	<span>
		<a id="totop-post-page">返回顶部</a>
		
			<a href="../../../../../2021/04/23/20184/markdown/" title="MD测试语法" rel="prev">
				&laquo;上一篇
			</a>
		
		
			<a href="../webpack-babel-1/" title="webpack-babel-1  基础配置、高级配置" rel="next">
				下一篇&raquo;
			</a>
			
	</span>


      		
				</div>	
			</div>
			
			<div class="investment-content">
				<div class="investment-content-list">
					

<div class="relate-post">
	
		<ul>
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="../../../../../2021/04/28/2021/react-jira-2/" title="慕课网 React Hook+TS4 （二）">
								慕课网 React Hook+TS4 （二）			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								四月 28日, 2021				
							</p>
							<p class="relate-post-content">
								第二章：《基于实例的 React16 傻瓜课程》。第三章：《神奇的 React 配合 typescript》
慕课网视频地址：https://coding.imooc.com/class/chapter/449.html
more
第...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="../../../../../2021/04/28/2021/react-jira-2/" title="慕课网 React Hook+TS4 （二）">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/images/cover/react-lifecycels.png" alt="慕课网 React Hook+TS4 （二）"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="../../../../../2021/04/28/2021/react-jira-1/" title="慕课网 React Hook+TS4 （一）">
								慕课网 React Hook+TS4 （一）			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								四月 28日, 2021				
							</p>
							<p class="relate-post-content">
								第一章：《欢迎来到类型的世界 - Typescript》
慕课网视频地址：https://coding.imooc.com/class/chapter/449.html
关键字：Any 类型、数组和元组、interface 、类型推论...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="../../../../../2021/04/28/2021/react-jira-1/" title="慕课网 React Hook+TS4 （一）">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/cart_cover.jpg" alt="慕课网 React Hook+TS4 （一）"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="../../../../../2021/04/23/20184/markdown/" title="MD测试语法">
								MD测试语法			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								四月 23日, 2021				
							</p>
							<p class="relate-post-content">
								主要是 hexo 写博客时常用的语法


Annie 主题定制化提示：

info   
success   
warning   
danger 

指定语言 附加说明 和 网址

App.jswww.baidu.com1测试代码块...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="../../../../../2021/04/23/20184/markdown/" title="MD测试语法">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/cart_cover.jpg" alt="MD测试语法"/>
							</a>
						</div>
					</li>												
			
		</ul>
	
</div>	
				</div>
				<div class="investment-content-list">
					<div class="layout-comment">

	

		

			<!-- gitalk comment -->
			<!-- show gitalk comment -->
<div id="gitalk-container"></div>

<!-- gitalk`s css & js -->
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<link rel="stylesheet" href="/css/comment.css">
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script type="text/javascript">

	(function gitalkComment(){
		//Thanks O-R
		//https://github.com/gitalk/gitalk/issues/102#issuecomment-382970552
		//去除尾部匹配正则数组的字符串  
		//Remove redundant characters
		String.prototype.trimEnd = function(regStr) {
			let result = this;
			if(regStr == undefined || regStr == null || regStr == "") {
				return result;
			}
			let array = regStr.split(',');

			if(array.length > 0) {

				let c = array.shift(), 
					str = this,
					i = str.length,
					rg = new RegExp(c),
					matchArr = str.match(rg);

				if(matchArr != undefined && matchArr != null && matchArr.length > 0) {
					let matchStr = matchArr[0].replace(/\\/g, "\\\\").replace(/\*/g, "\\*")
						.replace(/\+/g, "\\+").replace(/\|/g, "\\|")
						.replace(/\{/g, "\\{").replace(/\}/g, "\\}")
						.replace(/\(/g, "\\(").replace(/\)/g, "\\)")
						.replace(/\^/g, "\\^").replace(/\$/g, "\\$")
						.replace(/\[/g, "\\[").replace(/\]/g, "\\]")
						.replace(/\?/g, "\\?").replace(/\,/g, "\\,")
						.replace(/\./g, "\\.").replace(/\&/g, "\\&");
					matchStr = matchStr + '$';
					result = str.replace(new RegExp(matchStr), "");
				}

				if(array.length > 0) {
					return result.trimEnd(array.join())
				} else {
					return result;
				}
			}
		};

		//Create gitalk
		let gitalk = new Gitalk({
			clientID: '01919a648d33c758490c',
			clientSecret: 'b6b5eecd032ca01352b1e47aa08a580f86921929',
			//id: window.location.pathname,
			//id: decodeURI(window.location.pathname),
			//id: (window.location.pathname).split("/").pop().substring(0, 49),
			id: decodeURI( md5( location.href.trimEnd('#.*$,\\?.*$,index.html$') ) ),
			repo: 'Blog-Comment-Repo',
			owner: 'chen10221122',
			admin: 'chen10221122',
			distractionFreeMode: 'true',
		})
		gitalk.render('gitalk-container');		
	})();
</script>

		
		
	

</div>
				</div>
				<div class="investment-content-list">
					<div class="layout-share">
	
	

		
			
			<!-- socialShare share -->
			<div class="social-share"></div>

<!--  css & js -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
			
		
		
	
</div>


				</div>
			</div>	
		</div>
	</div>
</div>

<!-- show math formula -->



	 
	
<script src="../../../../../plugin/clipboard/clipboard.js"></script>

	<script>
		// Copy code !
	    function preprocessing() {
	        $("#article-content .highlight").each(function() {
	            $(this).wrap('<div id="post-code"></div>');
	        })

	        $("#article-content #post-code").each(function() {
	            $(this).prepend('<nav class="copy-nav"><span><i class="code-language"></i></span></nav>');
	        })

	        $("#article-content .copy-nav").each(function() {
	            let languageClass = $(this).next().attr('class'),
	                language = ((languageClass.length > 9) && (languageClass != null)) ? languageClass.substr(10) : "none"; //why 9? Need to check language?

	            $(this).find('.code-language').text(language);
	            $(this).append('<span class="copy-btn icon-paste"></span>');
	        });
	    }

		function copy() {
		    $('#article-content #post-code').each(function(i) {
		        let codeCopyId = 'codeCopy-' + i;

		        let codeNode = $(this).find('.code'),
		            copyButton = $(this).find('.copy-btn');

		        codeNode.attr('id', codeCopyId);
		        copyButton.attr('data-clipboard-target-id', codeCopyId);
		    })
   
			let clipboard = new ClipboardJS('.copy-btn', {
					target: function(trigger) {
						return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
					}
		      	});

			//pure js
			function showTooltip(elem, msg) {		   
				elem.setAttribute('aria-label', msg);
				elem.setAttribute('class', 'copy-btn icon-clipboard1');
				setTimeout(function() {
					elem.setAttribute('class', 'copy-btn icon-paste');
				}, 2000);
			}

			clipboard.on('success', function(e) {
			    e.clearSelection();
			    console.info('Action:', e.action);		   
			    console.info('Trigger:', e.trigger);
			    showTooltip(e.trigger, 'Copied!');   
			});
			
			clipboard.on('error', function(e) {
			    console.error('Action:', e.action);
			    console.error('Trigger:', e.trigger);
			});
		}
		
		(function copyCode(){
			if ($('.layout-post').length) {
			    preprocessing();
			    copy();
			} 
		})();
	</script>






<link rel="stylesheet" href="../../../../../plugin/fancybox/jquery.fancybox.css">


<script src="../../../../../plugin/fancybox/jquery.fancybox.js"></script>


<script type="text/javascript">
	(function gallerySet(){
		let titleID = $('.article-title a'),
			imageID = $('.article-content img'),
			videoID = $('.article-content video');
		
		let postTitle = titleID.text() ? titleID.text() : "No post title!";
		
		imageID.each(function() {
			let imgPath = $(this).attr('src'),
				imgTitle = $(this).attr('alt') ? $(this).attr('alt') : "No image description!";
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox="gallery" data-caption="《 ' + postTitle + ' 》' + imgTitle + '"href="' + imgPath + '"> </a>');
		});
		
		videoID.each(function() {
			let videoPath = $(this).attr('src');
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox href=" ' + videoPath + ' "> </a>');
		});
		
		//TODO：支持html5 video

		if($('#layout-post').length) {
			$('[data-fancybox="gallery"]').fancybox({
				loop: true,
				buttons: [
					"zoom",
					"share",
					"slideShow",
					"fullScreen",
					//"download",
					"thumbs",
					"close"
				],
				protect: true
			});
		}
	})();
</script>
		</main>

		<!--footer-->
		<footer>
	<div id="navigation-show">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="../../../../../index.html" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="../../../../../archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="../../../../../tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="../../../../../about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="../../../../../gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
	</div>

	<div class="copyright">
		<p>
			 
				&copy;2018 - 2021, content by chenlilin. All Rights Reserved.
			
			
				<!-- <a href="../../../../../http:/hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="../../../../../https:/github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay. -->
			
		</p>
		<p>
			

	<!-- busuanzi -->
	<!-- busuanzi -->



			<a href="javascript:zh_tran('s');" class="zh_click" id="zh_click_s">简体</a> 
			<a href="javascript:zh_tran('t');" class="zh_click" id="zh_click_t">繁體</a>				
		</p>
	</div>		
</footer>
		
	<!-- Local or hitokoto! -->

	
<script src="../../../../../plugin/motto/motto.js"></script>

	
	<script type="text/javascript">
		(function motto(){
			let mottoText = getMingYanContent().split('</br> - </br>'),
			
			mottoTextContent = mottoText[0]?mottoText[0]:'请刷新...',
			
			mottoTextFrom = mottoText[1]?mottoText[1]:'one/一个';
			
			mottoTextContent = mottoTextContent.trim().substring(0, 100);
		
			$("#motto-content").html( mottoTextContent);
			$("#motto-author").html( mottoTextFrom  );
		})();	
	</script>	



<!-- love effect -->

	
<script src="../../../../../plugin/love/love.js"></script>



<!-- back to top -->

	<div id="totop">
	<span class="icon-circle-up"></span>
</div>



<!-- site analysis -->


	<!-- site-analysis -->
	
	
	
	
	
 

<!-- leancloud -->


	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

  

	<!--
	时间：2018-10-3
	描述：
		插件名称：hexo-generator-search-zip
		插件来源: https://github.com/SuperKieran/hexo-generator-search-zip
		代码参考：https://github.com/SuperKieran/TKL/blob/master/layout/_partial/search.ejs(Include: js & css)	
-->
<div class="popup search-popup local-search-popup scrollbar" >
	<div class="local-search-container">
		<span class="popup-btn-close">
      		ESC
   		</span>
		<div class="local-search-header">
			<div class="input-prompt">				
			</div>
			<input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
		</div>
		<div class="local-search-body">
			<div id="local-search-output"></div>
		</div>
		<div class="local-search-footer">
			<div class="topN-post">				
				
								
			</div>
		</div>
	</div>
</div>


<script src="../../../../../plugin/search/ziploader.js"></script>
<script src="../../../../../js/search.js"></script>


<script type="text/javascript">
	var search_path = 'search.json',
		zip_Path = '/search.zip',
		version_Path = '/searchVersion.txt',
		input_Trigger = 'auto',
		top_N = '2';

	themeLocalSearch({
		search_path, 
		zip_Path, 
		version_Path, 
		input_Trigger, 
		top_N
	});
</script>



<script src="../../../../../plugin/chinese/chinese.js"></script>
<script src="../../../../../plugin/imagelazyloader/yall.min.js"></script>
<script src="../../../../../plugin/imageloaded/imagesloaded.pkgd.min.js"></script>
<script src="../../../../../plugin/nicescroll/jquery.nicescroll.js"></script>
<script src="../../../../../plugin/resizediv/resizediv.js"></script>
<script src="../../../../../js/main.js"></script>

	</body>	
</html>